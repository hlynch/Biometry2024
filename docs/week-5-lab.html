<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>10 Week 5 Lab | Biometry Lecture and Lab Notes</title>
  <meta name="description" content="10 Week 5 Lab | Biometry Lecture and Lab Notes" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="10 Week 5 Lab | Biometry Lecture and Lab Notes" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="10 Week 5 Lab | Biometry Lecture and Lab Notes" />
  
  
  

<meta name="author" content="Heather Lynch" />


<meta name="date" content="2024-04-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="week-5-lecture.html"/>
<link rel="next" href="week-6-lecture.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Biometry Lecture and Lab Notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface, data sets, and past exams</a></li>
<li class="chapter" data-level="1" data-path="week-1-lecture.html"><a href="week-1-lecture.html"><i class="fa fa-check"></i><b>1</b> Week 1 Lecture</a>
<ul>
<li class="chapter" data-level="1.1" data-path="week-1-lecture.html"><a href="week-1-lecture.html#week-1-readings"><i class="fa fa-check"></i><b>1.1</b> Week 1 Readings</a></li>
<li class="chapter" data-level="1.2" data-path="week-1-lecture.html"><a href="week-1-lecture.html#basic-outline"><i class="fa fa-check"></i><b>1.2</b> Basic Outline</a></li>
<li class="chapter" data-level="1.3" data-path="week-1-lecture.html"><a href="week-1-lecture.html#todays-agenda"><i class="fa fa-check"></i><b>1.3</b> Today’s Agenda</a></li>
<li class="chapter" data-level="1.4" data-path="week-1-lecture.html"><a href="week-1-lecture.html#basic-probability-theory"><i class="fa fa-check"></i><b>1.4</b> Basic Probability Theory</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="week-1-lecture.html"><a href="week-1-lecture.html#intersection"><i class="fa fa-check"></i><b>1.4.1</b> Intersection</a></li>
<li class="chapter" data-level="1.4.2" data-path="week-1-lecture.html"><a href="week-1-lecture.html#union"><i class="fa fa-check"></i><b>1.4.2</b> Union</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="week-1-lecture.html"><a href="week-1-lecture.html#multiple-events"><i class="fa fa-check"></i><b>1.5</b> Multiple events</a></li>
<li class="chapter" data-level="1.6" data-path="week-1-lecture.html"><a href="week-1-lecture.html#conditionals"><i class="fa fa-check"></i><b>1.6</b> Conditionals</a></li>
<li class="chapter" data-level="1.7" data-path="week-1-lecture.html"><a href="week-1-lecture.html#a-few-foundational-ideas"><i class="fa fa-check"></i><b>1.7</b> A few foundational ideas</a></li>
<li class="chapter" data-level="1.8" data-path="week-1-lecture.html"><a href="week-1-lecture.html#degrees-of-freedom"><i class="fa fa-check"></i><b>1.8</b> Degrees of freedom</a></li>
<li class="chapter" data-level="1.9" data-path="week-1-lecture.html"><a href="week-1-lecture.html#quick-intro-to-the-gaussian-distribution"><i class="fa fa-check"></i><b>1.9</b> Quick intro to the Gaussian distribution</a></li>
<li class="chapter" data-level="1.10" data-path="week-1-lecture.html"><a href="week-1-lecture.html#overview-of-univariate-distributions"><i class="fa fa-check"></i><b>1.10</b> Overview of Univariate Distributions</a></li>
<li class="chapter" data-level="1.11" data-path="week-1-lecture.html"><a href="week-1-lecture.html#what-can-you-ask-of-a-distribution"><i class="fa fa-check"></i><b>1.11</b> What can you ask of a distribution?</a>
<ul>
<li class="chapter" data-level="1.11.1" data-path="week-1-lecture.html"><a href="week-1-lecture.html#expected-value-of-a-random-variable"><i class="fa fa-check"></i><b>1.11.1</b> Expected Value of a Random Variable</a></li>
<li class="chapter" data-level="1.11.2" data-path="week-1-lecture.html"><a href="week-1-lecture.html#discrete-case"><i class="fa fa-check"></i><b>1.11.2</b> Discrete Case</a></li>
<li class="chapter" data-level="1.11.3" data-path="week-1-lecture.html"><a href="week-1-lecture.html#continuous-case"><i class="fa fa-check"></i><b>1.11.3</b> Continuous Case</a></li>
</ul></li>
<li class="chapter" data-level="1.12" data-path="week-1-lecture.html"><a href="week-1-lecture.html#a-brief-introduction-to-inference-logic-and-reasoning"><i class="fa fa-check"></i><b>1.12</b> A brief introduction to inference, logic, and reasoning</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="week-1-lab.html"><a href="week-1-lab.html"><i class="fa fa-check"></i><b>2</b> Week 1 Lab</a>
<ul>
<li class="chapter" data-level="2.1" data-path="week-1-lab.html"><a href="week-1-lab.html#using-r-like-a-calculator"><i class="fa fa-check"></i><b>2.1</b> Using R like a calculator</a></li>
<li class="chapter" data-level="2.2" data-path="week-1-lab.html"><a href="week-1-lab.html#the-basic-data-structures-in-r"><i class="fa fa-check"></i><b>2.2</b> The basic data structures in R</a></li>
<li class="chapter" data-level="2.3" data-path="week-1-lab.html"><a href="week-1-lab.html#writing-functions-in-r"><i class="fa fa-check"></i><b>2.3</b> Writing functions in R</a></li>
<li class="chapter" data-level="2.4" data-path="week-1-lab.html"><a href="week-1-lab.html#writing-loops-and-ifelse"><i class="fa fa-check"></i><b>2.4</b> Writing loops and if/else</a></li>
<li class="chapter" data-level="2.5" data-path="week-1-lab.html"><a href="week-1-lab.html#pop_vs_sample_var"><i class="fa fa-check"></i><b>2.5</b> (A short diversion) Bias in estimators</a></li>
<li class="chapter" data-level="2.6" data-path="week-1-lab.html"><a href="week-1-lab.html#some-practice-writing-r-code"><i class="fa fa-check"></i><b>2.6</b> Some practice writing R code</a></li>
<li class="chapter" data-level="2.7" data-path="week-1-lab.html"><a href="week-1-lab.html#a-few-final-notes"><i class="fa fa-check"></i><b>2.7</b> A few final notes</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="week-2-lecture.html"><a href="week-2-lecture.html"><i class="fa fa-check"></i><b>3</b> Week 2 Lecture</a>
<ul>
<li class="chapter" data-level="3.1" data-path="week-2-lecture.html"><a href="week-2-lecture.html#week-2-readings"><i class="fa fa-check"></i><b>3.1</b> Week 2 Readings</a></li>
<li class="chapter" data-level="3.2" data-path="week-2-lecture.html"><a href="week-2-lecture.html#todays-agenda-1"><i class="fa fa-check"></i><b>3.2</b> Today’s Agenda</a></li>
<li class="chapter" data-level="3.3" data-path="week-2-lecture.html"><a href="week-2-lecture.html#hypothesis-testing"><i class="fa fa-check"></i><b>3.3</b> Hypothesis testing</a></li>
<li class="chapter" data-level="3.4" data-path="week-2-lecture.html"><a href="week-2-lecture.html#permutation-tests"><i class="fa fa-check"></i><b>3.4</b> Permutation tests</a></li>
<li class="chapter" data-level="3.5" data-path="week-2-lecture.html"><a href="week-2-lecture.html#parameter-estimation"><i class="fa fa-check"></i><b>3.5</b> Parameter estimation</a></li>
<li class="chapter" data-level="3.6" data-path="week-2-lecture.html"><a href="week-2-lecture.html#method-1-non-parametric-bootstrap"><i class="fa fa-check"></i><b>3.6</b> Method #1: Non-parametric bootstrap</a></li>
<li class="chapter" data-level="3.7" data-path="week-2-lecture.html"><a href="week-2-lecture.html#parametric-bootstrap"><i class="fa fa-check"></i><b>3.7</b> Parametric bootstrap</a></li>
<li class="chapter" data-level="3.8" data-path="week-2-lecture.html"><a href="week-2-lecture.html#jackknife"><i class="fa fa-check"></i><b>3.8</b> Jackknife</a></li>
<li class="chapter" data-level="3.9" data-path="week-2-lecture.html"><a href="week-2-lecture.html#jackknife-after-bootstrap"><i class="fa fa-check"></i><b>3.9</b> Jackknife-after-bootstrap</a></li>
<li class="chapter" data-level="3.10" data-path="week-2-lecture.html"><a href="week-2-lecture.html#by-the-end-of-week-2-you-should-understand"><i class="fa fa-check"></i><b>3.10</b> By the end of Week 2, you should understand…</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="week-2-lab.html"><a href="week-2-lab.html"><i class="fa fa-check"></i><b>4</b> Week 2 Lab</a>
<ul>
<li class="chapter" data-level="4.1" data-path="week-2-lab.html"><a href="week-2-lab.html#confidence-intervals"><i class="fa fa-check"></i><b>4.1</b> Confidence intervals</a></li>
<li class="chapter" data-level="4.2" data-path="week-2-lab.html"><a href="week-2-lab.html#testing-hypotheses-through-permutation"><i class="fa fa-check"></i><b>4.2</b> Testing hypotheses through permutation</a></li>
<li class="chapter" data-level="4.3" data-path="week-2-lab.html"><a href="week-2-lab.html#basics-of-bootstrap-and-jackknife"><i class="fa fa-check"></i><b>4.3</b> Basics of bootstrap and jackknife</a></li>
<li class="chapter" data-level="4.4" data-path="week-2-lab.html"><a href="week-2-lab.html#calculating-bias-and-standard-error"><i class="fa fa-check"></i><b>4.4</b> Calculating bias and standard error</a></li>
<li class="chapter" data-level="4.5" data-path="week-2-lab.html"><a href="week-2-lab.html#parametric-bootstrap-1"><i class="fa fa-check"></i><b>4.5</b> Parametric bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="week-3-lecture.html"><a href="week-3-lecture.html"><i class="fa fa-check"></i><b>5</b> Week 3 Lecture</a>
<ul>
<li class="chapter" data-level="5.1" data-path="week-3-lecture.html"><a href="week-3-lecture.html#week-3-readings"><i class="fa fa-check"></i><b>5.1</b> Week 3 Readings</a></li>
<li class="chapter" data-level="5.2" data-path="week-3-lecture.html"><a href="week-3-lecture.html#overview-of-probability-distributions"><i class="fa fa-check"></i><b>5.2</b> Overview of probability distributions</a></li>
<li class="chapter" data-level="5.3" data-path="week-3-lecture.html"><a href="week-3-lecture.html#normal-gaussian-distribution"><i class="fa fa-check"></i><b>5.3</b> Normal (Gaussian) Distribution</a></li>
<li class="chapter" data-level="5.4" data-path="week-3-lecture.html"><a href="week-3-lecture.html#standard-normal-distribution"><i class="fa fa-check"></i><b>5.4</b> Standard Normal Distribution</a></li>
<li class="chapter" data-level="5.5" data-path="week-3-lecture.html"><a href="week-3-lecture.html#log-normal-distribution"><i class="fa fa-check"></i><b>5.5</b> Log-Normal Distribution</a></li>
<li class="chapter" data-level="5.6" data-path="week-3-lecture.html"><a href="week-3-lecture.html#intermission-central-limit-theorem"><i class="fa fa-check"></i><b>5.6</b> Intermission: Central Limit Theorem</a></li>
<li class="chapter" data-level="5.7" data-path="week-3-lecture.html"><a href="week-3-lecture.html#poisson-distribution"><i class="fa fa-check"></i><b>5.7</b> Poisson Distribution</a></li>
<li class="chapter" data-level="5.8" data-path="week-3-lecture.html"><a href="week-3-lecture.html#binomial-distribution"><i class="fa fa-check"></i><b>5.8</b> Binomial Distribution</a></li>
<li class="chapter" data-level="5.9" data-path="week-3-lecture.html"><a href="week-3-lecture.html#beta-distribution"><i class="fa fa-check"></i><b>5.9</b> Beta Distribution</a></li>
<li class="chapter" data-level="5.10" data-path="week-3-lecture.html"><a href="week-3-lecture.html#gamma-distribution"><i class="fa fa-check"></i><b>5.10</b> Gamma Distribution</a></li>
<li class="chapter" data-level="5.11" data-path="week-3-lecture.html"><a href="week-3-lecture.html#some-additional-notes"><i class="fa fa-check"></i><b>5.11</b> Some additional notes:</a></li>
<li class="chapter" data-level="5.12" data-path="week-3-lecture.html"><a href="week-3-lecture.html#by-the-end-of-week-3-you-should-understand"><i class="fa fa-check"></i><b>5.12</b> By the end of Week 3, you should understand…</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="week-3-lab.html"><a href="week-3-lab.html"><i class="fa fa-check"></i><b>6</b> Week 3 Lab</a>
<ul>
<li class="chapter" data-level="6.1" data-path="week-3-lab.html"><a href="week-3-lab.html#exploring-the-univariate-distributions-with-r"><i class="fa fa-check"></i><b>6.1</b> Exploring the univariate distributions with R</a></li>
<li class="chapter" data-level="6.2" data-path="week-3-lab.html"><a href="week-3-lab.html#standard-deviation-vs.-standard-error"><i class="fa fa-check"></i><b>6.2</b> Standard deviation vs. Standard error</a></li>
<li class="chapter" data-level="6.3" data-path="week-3-lab.html"><a href="week-3-lab.html#the-central-limit-theorem"><i class="fa fa-check"></i><b>6.3</b> The Central Limit Theorem</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="week-4-lecture.html"><a href="week-4-lecture.html"><i class="fa fa-check"></i><b>7</b> Week 4 Lecture</a>
<ul>
<li class="chapter" data-level="7.1" data-path="week-4-lecture.html"><a href="week-4-lecture.html#week-4-readings"><i class="fa fa-check"></i><b>7.1</b> Week 4 Readings</a></li>
<li class="chapter" data-level="7.2" data-path="week-4-lecture.html"><a href="week-4-lecture.html#t-distribution"><i class="fa fa-check"></i><b>7.2</b> t-distribution</a></li>
<li class="chapter" data-level="7.3" data-path="week-4-lecture.html"><a href="week-4-lecture.html#chi-squared-distribution"><i class="fa fa-check"></i><b>7.3</b> Chi-squared distribution</a></li>
<li class="chapter" data-level="7.4" data-path="week-4-lecture.html"><a href="week-4-lecture.html#f-distribution"><i class="fa fa-check"></i><b>7.4</b> F distribution</a></li>
<li class="chapter" data-level="7.5" data-path="week-4-lecture.html"><a href="week-4-lecture.html#estimating-confidence-intervals---5-special-cases"><i class="fa fa-check"></i><b>7.5</b> Estimating confidence intervals - 5 special cases</a></li>
<li class="chapter" data-level="7.6" data-path="week-4-lecture.html"><a href="week-4-lecture.html#to-recap"><i class="fa fa-check"></i><b>7.6</b> To recap</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="week-4-lab.html"><a href="week-4-lab.html"><i class="fa fa-check"></i><b>8</b> Week 4 Lab</a></li>
<li class="chapter" data-level="9" data-path="week-5-lecture.html"><a href="week-5-lecture.html"><i class="fa fa-check"></i><b>9</b> Week 5 Lecture</a>
<ul>
<li class="chapter" data-level="9.1" data-path="week-5-lecture.html"><a href="week-5-lecture.html#week-5-readings"><i class="fa fa-check"></i><b>9.1</b> Week 5 Readings</a></li>
<li class="chapter" data-level="9.2" data-path="week-5-lecture.html"><a href="week-5-lecture.html#statistical-power"><i class="fa fa-check"></i><b>9.2</b> Statistical power</a></li>
<li class="chapter" data-level="9.3" data-path="week-5-lecture.html"><a href="week-5-lecture.html#the-single-sample-t-test"><i class="fa fa-check"></i><b>9.3</b> The single sample t test</a></li>
<li class="chapter" data-level="9.4" data-path="week-5-lecture.html"><a href="week-5-lecture.html#the-unpaired-two-sample-t-test"><i class="fa fa-check"></i><b>9.4</b> The unpaired two sample t test</a></li>
<li class="chapter" data-level="9.5" data-path="week-5-lecture.html"><a href="week-5-lecture.html#pooledvar"><i class="fa fa-check"></i><b>9.5</b> Pooling the variances</a></li>
<li class="chapter" data-level="9.6" data-path="week-5-lecture.html"><a href="week-5-lecture.html#the-paired-two-sample-t-test"><i class="fa fa-check"></i><b>9.6</b> The paired two sample t test</a></li>
<li class="chapter" data-level="9.7" data-path="week-5-lecture.html"><a href="week-5-lecture.html#the-f-test"><i class="fa fa-check"></i><b>9.7</b> The F test</a></li>
<li class="chapter" data-level="9.8" data-path="week-5-lecture.html"><a href="week-5-lecture.html#comparing-two-proportions"><i class="fa fa-check"></i><b>9.8</b> Comparing two proportions</a></li>
<li class="chapter" data-level="9.9" data-path="week-5-lecture.html"><a href="week-5-lecture.html#comparing-two-distributions"><i class="fa fa-check"></i><b>9.9</b> Comparing two distributions</a></li>
<li class="chapter" data-level="9.10" data-path="week-5-lecture.html"><a href="week-5-lecture.html#a-bit-more-detail-on-the-binomial"><i class="fa fa-check"></i><b>9.10</b> A bit more detail on the Binomial</a></li>
<li class="chapter" data-level="9.11" data-path="week-5-lecture.html"><a href="week-5-lecture.html#side-note-about-the-wald-test"><i class="fa fa-check"></i><b>9.11</b> Side-note about the Wald test</a></li>
<li class="chapter" data-level="9.12" data-path="week-5-lecture.html"><a href="week-5-lecture.html#chi-squared-goodness-of-fit-test"><i class="fa fa-check"></i><b>9.12</b> Chi-squared goodness-of-fit test</a></li>
<li class="chapter" data-level="9.13" data-path="week-5-lecture.html"><a href="week-5-lecture.html#chi-squared-test-of-independence"><i class="fa fa-check"></i><b>9.13</b> Chi-squared test of independence</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="week-5-lab.html"><a href="week-5-lab.html"><i class="fa fa-check"></i><b>10</b> Week 5 Lab</a>
<ul>
<li class="chapter" data-level="10.1" data-path="week-5-lab.html"><a href="week-5-lab.html#t-test"><i class="fa fa-check"></i><b>10.1</b> t-test</a></li>
<li class="chapter" data-level="10.2" data-path="week-5-lab.html"><a href="week-5-lab.html#f-test"><i class="fa fa-check"></i><b>10.2</b> F-test</a></li>
<li class="chapter" data-level="10.3" data-path="week-5-lab.html"><a href="week-5-lab.html#comparing-two-proportions-1"><i class="fa fa-check"></i><b>10.3</b> Comparing two proportions</a></li>
<li class="chapter" data-level="10.4" data-path="week-5-lab.html"><a href="week-5-lab.html#comparing-two-distributions-1"><i class="fa fa-check"></i><b>10.4</b> Comparing two distributions</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="week-6-lecture.html"><a href="week-6-lecture.html"><i class="fa fa-check"></i><b>11</b> Week 6 Lecture</a>
<ul>
<li class="chapter" data-level="11.1" data-path="week-6-lecture.html"><a href="week-6-lecture.html#week-6-readings"><i class="fa fa-check"></i><b>11.1</b> Week 6 Readings</a></li>
<li class="chapter" data-level="11.2" data-path="week-6-lecture.html"><a href="week-6-lecture.html#family-wise-error-rates"><i class="fa fa-check"></i><b>11.2</b> Family-wise error rates</a></li>
<li class="chapter" data-level="11.3" data-path="week-6-lecture.html"><a href="week-6-lecture.html#how-do-we-sort-the-signal-from-the-noise"><i class="fa fa-check"></i><b>11.3</b> How do we sort the signal from the noise?</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="week-6-lab.html"><a href="week-6-lab.html"><i class="fa fa-check"></i><b>12</b> Week 6 Lab</a></li>
<li class="chapter" data-level="13" data-path="week-7-lecturelab.html"><a href="week-7-lecturelab.html"><i class="fa fa-check"></i><b>13</b> Week 7 Lecture/Lab</a>
<ul>
<li class="chapter" data-level="13.1" data-path="week-7-lecturelab.html"><a href="week-7-lecturelab.html#week-7-readings"><i class="fa fa-check"></i><b>13.1</b> Week 7 Readings</a></li>
<li class="chapter" data-level="13.2" data-path="week-7-lecturelab.html"><a href="week-7-lecturelab.html#introduction-to-plotting-in-r"><i class="fa fa-check"></i><b>13.2</b> Introduction to plotting in R</a></li>
<li class="chapter" data-level="13.3" data-path="week-7-lecturelab.html"><a href="week-7-lecturelab.html#box-plots"><i class="fa fa-check"></i><b>13.3</b> Box plots</a></li>
<li class="chapter" data-level="13.4" data-path="week-7-lecturelab.html"><a href="week-7-lecturelab.html#two-dimensional-data"><i class="fa fa-check"></i><b>13.4</b> Two-dimensional data</a></li>
<li class="chapter" data-level="13.5" data-path="week-7-lecturelab.html"><a href="week-7-lecturelab.html#three-dimensional-data"><i class="fa fa-check"></i><b>13.5</b> Three-dimensional data</a></li>
<li class="chapter" data-level="13.6" data-path="week-7-lecturelab.html"><a href="week-7-lecturelab.html#multiple-plots"><i class="fa fa-check"></i><b>13.6</b> Multiple plots</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="week-8-lecture.html"><a href="week-8-lecture.html"><i class="fa fa-check"></i><b>14</b> Week 8 Lecture</a>
<ul>
<li class="chapter" data-level="14.1" data-path="week-8-lecture.html"><a href="week-8-lecture.html#week-8-readings"><i class="fa fa-check"></i><b>14.1</b> Week 8 Readings</a></li>
<li class="chapter" data-level="14.2" data-path="week-8-lecture.html"><a href="week-8-lecture.html#warm-up"><i class="fa fa-check"></i><b>14.2</b> Warm-up</a></li>
<li class="chapter" data-level="14.3" data-path="week-8-lecture.html"><a href="week-8-lecture.html#the-aims-of-modelling-a-discussion-of-shmueli-2010"><i class="fa fa-check"></i><b>14.3</b> The aims of modelling – A discussion of Shmueli (2010)</a></li>
<li class="chapter" data-level="14.4" data-path="week-8-lecture.html"><a href="week-8-lecture.html#introduction-to-linear-models"><i class="fa fa-check"></i><b>14.4</b> Introduction to linear models</a></li>
<li class="chapter" data-level="14.5" data-path="week-8-lecture.html"><a href="week-8-lecture.html#linear-models-example-with-continuous-covariate"><i class="fa fa-check"></i><b>14.5</b> Linear models | example with continuous covariate</a></li>
<li class="chapter" data-level="14.6" data-path="week-8-lecture.html"><a href="week-8-lecture.html#resolving-overparameterization-using-contrasts"><i class="fa fa-check"></i><b>14.6</b> Resolving overparameterization using contrasts</a></li>
<li class="chapter" data-level="14.7" data-path="week-8-lecture.html"><a href="week-8-lecture.html#effect-codingtreatment-constrast"><i class="fa fa-check"></i><b>14.7</b> Effect coding/Treatment constrast</a></li>
<li class="chapter" data-level="14.8" data-path="week-8-lecture.html"><a href="week-8-lecture.html#helmert-contrasts"><i class="fa fa-check"></i><b>14.8</b> Helmert contrasts</a></li>
<li class="chapter" data-level="14.9" data-path="week-8-lecture.html"><a href="week-8-lecture.html#sum-to-zero-contrasts"><i class="fa fa-check"></i><b>14.9</b> Sum-to-zero contrasts</a></li>
<li class="chapter" data-level="14.10" data-path="week-8-lecture.html"><a href="week-8-lecture.html#polynomial-contrasts"><i class="fa fa-check"></i><b>14.10</b> Polynomial contrasts</a></li>
<li class="chapter" data-level="14.11" data-path="week-8-lecture.html"><a href="week-8-lecture.html#visualizing-hypotheses-for-different-coding-schemes"><i class="fa fa-check"></i><b>14.11</b> Visualizing hypotheses for different coding schemes</a></li>
<li class="chapter" data-level="14.12" data-path="week-8-lecture.html"><a href="week-8-lecture.html#orthogonal-vs.-non-orthogonal-contrasts"><i class="fa fa-check"></i><b>14.12</b> Orthogonal vs. Non-orthogonal contrasts</a></li>
<li class="chapter" data-level="14.13" data-path="week-8-lecture.html"><a href="week-8-lecture.html#error-structure-of-linear-models"><i class="fa fa-check"></i><b>14.13</b> Error structure of linear models</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="week-8-lab.html"><a href="week-8-lab.html"><i class="fa fa-check"></i><b>15</b> Week 8 Lab</a>
<ul>
<li class="chapter" data-level="15.1" data-path="week-8-lab.html"><a href="week-8-lab.html#covariate-as-number-vs.-covariate-as-factor"><i class="fa fa-check"></i><b>15.1</b> Covariate as number vs. covariate as factor</a></li>
<li class="chapter" data-level="15.2" data-path="week-8-lab.html"><a href="week-8-lab.html#helmert-contrasts-in-r"><i class="fa fa-check"></i><b>15.2</b> Helmert contrasts in R</a></li>
<li class="chapter" data-level="15.3" data-path="week-8-lab.html"><a href="week-8-lab.html#polynomial-contrasts-in-r"><i class="fa fa-check"></i><b>15.3</b> Polynomial contrasts in R</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="week-9-lecture.html"><a href="week-9-lecture.html"><i class="fa fa-check"></i><b>16</b> Week 9 Lecture</a>
<ul>
<li class="chapter" data-level="16.1" data-path="week-9-lecture.html"><a href="week-9-lecture.html#week-9-readings"><i class="fa fa-check"></i><b>16.1</b> Week 9 Readings</a></li>
<li class="chapter" data-level="16.2" data-path="week-9-lecture.html"><a href="week-9-lecture.html#correlation"><i class="fa fa-check"></i><b>16.2</b> Correlation</a></li>
<li class="chapter" data-level="16.3" data-path="week-9-lecture.html"><a href="week-9-lecture.html#hypothesis-testing---pearsons-r"><i class="fa fa-check"></i><b>16.3</b> Hypothesis testing - Pearson’s <em>r</em></a></li>
<li class="chapter" data-level="16.4" data-path="week-9-lecture.html"><a href="week-9-lecture.html#fishers-z"><i class="fa fa-check"></i><b>16.4</b> Fisher’s <span class="math inline">\(z\)</span></a></li>
<li class="chapter" data-level="16.5" data-path="week-9-lecture.html"><a href="week-9-lecture.html#regression"><i class="fa fa-check"></i><b>16.5</b> Regression</a></li>
<li class="chapter" data-level="16.6" data-path="week-9-lecture.html"><a href="week-9-lecture.html#estimating-the-slope-and-intercept-in-linear-regression"><i class="fa fa-check"></i><b>16.6</b> Estimating the slope and intercept in linear regression</a></li>
<li class="chapter" data-level="16.7" data-path="week-9-lecture.html"><a href="week-9-lecture.html#ok-now-the-other-derivation-for-slope-and-intercept"><i class="fa fa-check"></i><b>16.7</b> OK, now the “other” derivation for slope and intercept</a></li>
<li class="chapter" data-level="16.8" data-path="week-9-lecture.html"><a href="week-9-lecture.html#assumptions-of-regression"><i class="fa fa-check"></i><b>16.8</b> Assumptions of regression</a></li>
<li class="chapter" data-level="16.9" data-path="week-9-lecture.html"><a href="week-9-lecture.html#confidence-vs.-prediction-intervals"><i class="fa fa-check"></i><b>16.9</b> Confidence vs. Prediction intervals</a></li>
<li class="chapter" data-level="16.10" data-path="week-9-lecture.html"><a href="week-9-lecture.html#how-do-we-know-if-our-model-is-any-good"><i class="fa fa-check"></i><b>16.10</b> How do we know if our model is any good?</a></li>
<li class="chapter" data-level="16.11" data-path="week-9-lecture.html"><a href="week-9-lecture.html#robust-regression"><i class="fa fa-check"></i><b>16.11</b> Robust regression</a></li>
<li class="chapter" data-level="16.12" data-path="week-9-lecture.html"><a href="week-9-lecture.html#type-i-and-type-ii-regression"><i class="fa fa-check"></i><b>16.12</b> Type I and Type II Regression</a></li>
<li class="chapter" data-level="16.13" data-path="week-9-lecture.html"><a href="week-9-lecture.html#W9FAQ"><i class="fa fa-check"></i><b>16.13</b> Week 9 FAQ</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="week-9-lab.html"><a href="week-9-lab.html"><i class="fa fa-check"></i><b>17</b> Week 9 Lab</a>
<ul>
<li class="chapter" data-level="17.1" data-path="week-9-lab.html"><a href="week-9-lab.html#correlation-1"><i class="fa fa-check"></i><b>17.1</b> Correlation</a></li>
<li class="chapter" data-level="17.2" data-path="week-9-lab.html"><a href="week-9-lab.html#linear-modelling"><i class="fa fa-check"></i><b>17.2</b> Linear modelling</a></li>
<li class="chapter" data-level="17.3" data-path="week-9-lab.html"><a href="week-9-lab.html#centering-the-covariates"><i class="fa fa-check"></i><b>17.3</b> Centering the covariates</a></li>
<li class="chapter" data-level="17.4" data-path="week-9-lab.html"><a href="week-9-lab.html#weighted-regression"><i class="fa fa-check"></i><b>17.4</b> Weighted regression</a></li>
<li class="chapter" data-level="17.5" data-path="week-9-lab.html"><a href="week-9-lab.html#robust-regression-1"><i class="fa fa-check"></i><b>17.5</b> Robust regression</a></li>
<li class="chapter" data-level="17.6" data-path="week-9-lab.html"><a href="week-9-lab.html#bootstrapping-standard-errors-for-robust-regression"><i class="fa fa-check"></i><b>17.6</b> Bootstrapping standard errors for robust regression</a></li>
<li class="chapter" data-level="17.7" data-path="week-9-lab.html"><a href="week-9-lab.html#type-i-vs.-type-ii-regression-the-smatr-package"><i class="fa fa-check"></i><b>17.7</b> Type I vs. Type II regression: The ‘smatr’ package</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="week-10-lecture.html"><a href="week-10-lecture.html"><i class="fa fa-check"></i><b>18</b> Week 10 Lecture</a>
<ul>
<li class="chapter" data-level="18.1" data-path="week-10-lecture.html"><a href="week-10-lecture.html#week-10-readings"><i class="fa fa-check"></i><b>18.1</b> Week 10 Readings</a></li>
<li class="chapter" data-level="18.2" data-path="week-10-lecture.html"><a href="week-10-lecture.html#week-10-outline"><i class="fa fa-check"></i><b>18.2</b> Week 10 outline</a></li>
<li class="chapter" data-level="18.3" data-path="week-10-lecture.html"><a href="week-10-lecture.html#an-example"><i class="fa fa-check"></i><b>18.3</b> An example</a></li>
<li class="chapter" data-level="18.4" data-path="week-10-lecture.html"><a href="week-10-lecture.html#generalized-linear-models"><i class="fa fa-check"></i><b>18.4</b> Generalized linear models</a></li>
<li class="chapter" data-level="18.5" data-path="week-10-lecture.html"><a href="week-10-lecture.html#logistic-regression"><i class="fa fa-check"></i><b>18.5</b> Logistic regression</a></li>
<li class="chapter" data-level="18.6" data-path="week-10-lecture.html"><a href="week-10-lecture.html#fitting-a-glm"><i class="fa fa-check"></i><b>18.6</b> Fitting a GLM</a></li>
<li class="chapter" data-level="18.7" data-path="week-10-lecture.html"><a href="week-10-lecture.html#poisson-regression"><i class="fa fa-check"></i><b>18.7</b> Poisson regression</a></li>
<li class="chapter" data-level="18.8" data-path="week-10-lecture.html"><a href="week-10-lecture.html#deviance"><i class="fa fa-check"></i><b>18.8</b> Deviance</a></li>
<li class="chapter" data-level="18.9" data-path="week-10-lecture.html"><a href="week-10-lecture.html#other-methods-loess-splines-gams"><i class="fa fa-check"></i><b>18.9</b> Other methods – LOESS, splines, GAMs</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="week-10-lab.html"><a href="week-10-lab.html"><i class="fa fa-check"></i><b>19</b> Week 10 Lab</a>
<ul>
<li class="chapter" data-level="19.1" data-path="week-10-lab.html"><a href="week-10-lab.html#discussion-of-challenger-analysis"><i class="fa fa-check"></i><b>19.1</b> Discussion of Challenger analysis</a></li>
<li class="chapter" data-level="19.2" data-path="week-10-lab.html"><a href="week-10-lab.html#weighted-linear-regression"><i class="fa fa-check"></i><b>19.2</b> Weighted linear regression</a></li>
<li class="chapter" data-level="19.3" data-path="week-10-lab.html"><a href="week-10-lab.html#logistic-regression-practice"><i class="fa fa-check"></i><b>19.3</b> Logistic regression practice</a></li>
<li class="chapter" data-level="19.4" data-path="week-10-lab.html"><a href="week-10-lab.html#poisson-regression-practice"><i class="fa fa-check"></i><b>19.4</b> Poisson regression practice</a></li>
<li class="chapter" data-level="19.5" data-path="week-10-lab.html"><a href="week-10-lab.html#getting-a-feel-for-deviance"><i class="fa fa-check"></i><b>19.5</b> Getting a feel for Deviance</a></li>
<li class="chapter" data-level="19.6" data-path="week-10-lab.html"><a href="week-10-lab.html#generalized-additive-models"><i class="fa fa-check"></i><b>19.6</b> Generalized Additive Models</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="week-11-lecture.html"><a href="week-11-lecture.html"><i class="fa fa-check"></i><b>20</b> Week 11 Lecture</a>
<ul>
<li class="chapter" data-level="20.1" data-path="week-11-lecture.html"><a href="week-11-lecture.html#week-11-readings"><i class="fa fa-check"></i><b>20.1</b> Week 11 Readings</a></li>
<li class="chapter" data-level="20.2" data-path="week-11-lecture.html"><a href="week-11-lecture.html#week-11-outline"><i class="fa fa-check"></i><b>20.2</b> Week 11 outline</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="week-11-lecture.html"><a href="week-11-lecture.html#variation-within-treatment-group"><i class="fa fa-check"></i><b>20.2.1</b> Variation within treatment group</a></li>
<li class="chapter" data-level="20.2.2" data-path="week-11-lecture.html"><a href="week-11-lecture.html#variation-among-treatment-group-means"><i class="fa fa-check"></i><b>20.2.2</b> Variation among treatment group means</a></li>
<li class="chapter" data-level="20.2.3" data-path="week-11-lecture.html"><a href="week-11-lecture.html#comparing-variance-components"><i class="fa fa-check"></i><b>20.2.3</b> Comparing variance components</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="week-11-lecture.html"><a href="week-11-lecture.html#comparing-variance-components-1"><i class="fa fa-check"></i><b>20.3</b> Comparing variance components</a></li>
<li class="chapter" data-level="20.4" data-path="week-11-lecture.html"><a href="week-11-lecture.html#two-ways-to-estimate-variance"><i class="fa fa-check"></i><b>20.4</b> Two ways to estimate variance</a></li>
<li class="chapter" data-level="20.5" data-path="week-11-lecture.html"><a href="week-11-lecture.html#single-factor-anova"><i class="fa fa-check"></i><b>20.5</b> Single-factor ANOVA</a></li>
<li class="chapter" data-level="20.6" data-path="week-11-lecture.html"><a href="week-11-lecture.html#fixed-effects-vs.-random-effects"><i class="fa fa-check"></i><b>20.6</b> Fixed effects vs. random effects</a></li>
<li class="chapter" data-level="20.7" data-path="week-11-lecture.html"><a href="week-11-lecture.html#post-hoc-tests"><i class="fa fa-check"></i><b>20.7</b> Post-hoc tests</a>
<ul>
<li class="chapter" data-level="20.7.1" data-path="week-11-lecture.html"><a href="week-11-lecture.html#tukeys-hsd"><i class="fa fa-check"></i><b>20.7.1</b> Tukey’s HSD</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="week-11-lab.html"><a href="week-11-lab.html"><i class="fa fa-check"></i><b>21</b> Week 11 Lab</a>
<ul>
<li class="chapter" data-level="21.1" data-path="week-11-lab.html"><a href="week-11-lab.html#rs-anova-functions"><i class="fa fa-check"></i><b>21.1</b> R’s ANOVA functions</a></li>
<li class="chapter" data-level="21.2" data-path="week-11-lab.html"><a href="week-11-lab.html#single-factor-anova-in-r"><i class="fa fa-check"></i><b>21.2</b> Single-factor ANOVA in R</a></li>
<li class="chapter" data-level="21.3" data-path="week-11-lab.html"><a href="week-11-lab.html#follow-up-analyses-to-anova"><i class="fa fa-check"></i><b>21.3</b> Follow up analyses to ANOVA</a></li>
<li class="chapter" data-level="21.4" data-path="week-11-lab.html"><a href="week-11-lab.html#more-practice-model-i-anova"><i class="fa fa-check"></i><b>21.4</b> More practice: Model I ANOVA</a></li>
<li class="chapter" data-level="21.5" data-path="week-11-lab.html"><a href="week-11-lab.html#more-practice-brief-intro-to-doing-model-ii-anova-in-r"><i class="fa fa-check"></i><b>21.5</b> More practice: Brief intro to doing Model II ANOVA in R</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="week-12-lecture.html"><a href="week-12-lecture.html"><i class="fa fa-check"></i><b>22</b> Week 12 Lecture</a>
<ul>
<li class="chapter" data-level="22.1" data-path="week-12-lecture.html"><a href="week-12-lecture.html#week-12-readings"><i class="fa fa-check"></i><b>22.1</b> Week 12 Readings</a></li>
<li class="chapter" data-level="22.2" data-path="week-12-lecture.html"><a href="week-12-lecture.html#week-12-outline"><i class="fa fa-check"></i><b>22.2</b> Week 12 outline</a></li>
<li class="chapter" data-level="22.3" data-path="week-12-lecture.html"><a href="week-12-lecture.html#review-anova-with-one-factor"><i class="fa fa-check"></i><b>22.3</b> Review: ANOVA with one factor</a></li>
<li class="chapter" data-level="22.4" data-path="week-12-lecture.html"><a href="week-12-lecture.html#anova-with-more-than-one-factor"><i class="fa fa-check"></i><b>22.4</b> ANOVA with more than one factor</a></li>
<li class="chapter" data-level="22.5" data-path="week-12-lecture.html"><a href="week-12-lecture.html#two-way-anova-factorial-designs"><i class="fa fa-check"></i><b>22.5</b> Two-way ANOVA factorial designs</a></li>
<li class="chapter" data-level="22.6" data-path="week-12-lecture.html"><a href="week-12-lecture.html#why-bother-with-random-effects"><i class="fa fa-check"></i><b>22.6</b> Why bother with random effects?</a></li>
<li class="chapter" data-level="22.7" data-path="week-12-lecture.html"><a href="week-12-lecture.html#mixed-model"><i class="fa fa-check"></i><b>22.7</b> Mixed model</a></li>
<li class="chapter" data-level="22.8" data-path="week-12-lecture.html"><a href="week-12-lecture.html#unbalanced-designs"><i class="fa fa-check"></i><b>22.8</b> Unbalanced designs</a>
<ul>
<li class="chapter" data-level="22.8.1" data-path="week-12-lecture.html"><a href="week-12-lecture.html#unbalanced-design-different-sample-sizes"><i class="fa fa-check"></i><b>22.8.1</b> Unbalanced design – Different sample sizes</a></li>
<li class="chapter" data-level="22.8.2" data-path="week-12-lecture.html"><a href="week-12-lecture.html#type-i-sequential-sums-of-squares"><i class="fa fa-check"></i><b>22.8.2</b> Type I (sequential) sums of squares</a></li>
<li class="chapter" data-level="22.8.3" data-path="week-12-lecture.html"><a href="week-12-lecture.html#type-ii-hierarchical-sums-of-squares"><i class="fa fa-check"></i><b>22.8.3</b> Type II (hierarchical) sums of squares</a></li>
<li class="chapter" data-level="22.8.4" data-path="week-12-lecture.html"><a href="week-12-lecture.html#type-iii-marginal-sums-of-squares"><i class="fa fa-check"></i><b>22.8.4</b> Type III (marginal) sums of squares</a></li>
<li class="chapter" data-level="22.8.5" data-path="week-12-lecture.html"><a href="week-12-lecture.html#comparing-type-i-ii-and-iii-ss"><i class="fa fa-check"></i><b>22.8.5</b> Comparing type I, II, and III SS</a></li>
</ul></li>
<li class="chapter" data-level="22.9" data-path="week-12-lecture.html"><a href="week-12-lecture.html#unbalanced-design-missing-cell"><i class="fa fa-check"></i><b>22.9</b> Unbalanced design – Missing cell</a></li>
<li class="chapter" data-level="22.10" data-path="week-12-lecture.html"><a href="week-12-lecture.html#two-factor-nested-anova"><i class="fa fa-check"></i><b>22.10</b> Two factor nested ANOVA</a>
<ul>
<li class="chapter" data-level="22.10.1" data-path="week-12-lecture.html"><a href="week-12-lecture.html#potential-issues-with-nested-designs"><i class="fa fa-check"></i><b>22.10.1</b> Potential issues with nested designs</a></li>
</ul></li>
<li class="chapter" data-level="22.11" data-path="week-12-lecture.html"><a href="week-12-lecture.html#experimental-design"><i class="fa fa-check"></i><b>22.11</b> Experimental design</a>
<ul>
<li class="chapter" data-level="22.11.1" data-path="week-12-lecture.html"><a href="week-12-lecture.html#completely-randomized-design"><i class="fa fa-check"></i><b>22.11.1</b> Completely randomized design</a></li>
<li class="chapter" data-level="22.11.2" data-path="week-12-lecture.html"><a href="week-12-lecture.html#randomized-block-design"><i class="fa fa-check"></i><b>22.11.2</b> Randomized block design</a></li>
<li class="chapter" data-level="22.11.3" data-path="week-12-lecture.html"><a href="week-12-lecture.html#latin-square-design"><i class="fa fa-check"></i><b>22.11.3</b> Latin square design</a></li>
<li class="chapter" data-level="22.11.4" data-path="week-12-lecture.html"><a href="week-12-lecture.html#split-plot-design"><i class="fa fa-check"></i><b>22.11.4</b> Split plot design</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="week-12-lab.html"><a href="week-12-lab.html"><i class="fa fa-check"></i><b>23</b> Week 12 Lab</a>
<ul>
<li class="chapter" data-level="23.1" data-path="week-12-lab.html"><a href="week-12-lab.html#example-1-two-way-factorial-anova-in-r"><i class="fa fa-check"></i><b>23.1</b> Example #1: Two-way factorial ANOVA in R</a></li>
<li class="chapter" data-level="23.2" data-path="week-12-lab.html"><a href="week-12-lab.html#example-2-nested-design"><i class="fa fa-check"></i><b>23.2</b> Example #2: Nested design</a></li>
<li class="chapter" data-level="23.3" data-path="week-12-lab.html"><a href="week-12-lab.html#example-3-nested-design"><i class="fa fa-check"></i><b>23.3</b> Example #3: Nested design</a></li>
<li class="chapter" data-level="23.4" data-path="week-12-lab.html"><a href="week-12-lab.html#example-4-randomized-block-design"><i class="fa fa-check"></i><b>23.4</b> Example #4: Randomized Block Design</a></li>
<li class="chapter" data-level="23.5" data-path="week-12-lab.html"><a href="week-12-lab.html#example-5-nested-design"><i class="fa fa-check"></i><b>23.5</b> Example #5: Nested design</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="week-13-lecture.html"><a href="week-13-lecture.html"><i class="fa fa-check"></i><b>24</b> Week 13 Lecture</a>
<ul>
<li class="chapter" data-level="24.1" data-path="week-13-lecture.html"><a href="week-13-lecture.html#week-13-readings"><i class="fa fa-check"></i><b>24.1</b> Week 13 Readings</a></li>
<li class="chapter" data-level="24.2" data-path="week-13-lecture.html"><a href="week-13-lecture.html#model-criticism"><i class="fa fa-check"></i><b>24.2</b> Model criticism</a></li>
<li class="chapter" data-level="24.3" data-path="week-13-lecture.html"><a href="week-13-lecture.html#residuals"><i class="fa fa-check"></i><b>24.3</b> Residuals</a></li>
<li class="chapter" data-level="24.4" data-path="week-13-lecture.html"><a href="week-13-lecture.html#leverage"><i class="fa fa-check"></i><b>24.4</b> Leverage</a></li>
<li class="chapter" data-level="24.5" data-path="week-13-lecture.html"><a href="week-13-lecture.html#influence"><i class="fa fa-check"></i><b>24.5</b> Influence</a></li>
<li class="chapter" data-level="24.6" data-path="week-13-lecture.html"><a href="week-13-lecture.html#comparing-residuals-leverage-and-influence"><i class="fa fa-check"></i><b>24.6</b> Comparing residuals, leverage, and influence</a></li>
<li class="chapter" data-level="24.7" data-path="week-13-lecture.html"><a href="week-13-lecture.html#residuals-for-glms"><i class="fa fa-check"></i><b>24.7</b> Residuals for GLMs</a></li>
<li class="chapter" data-level="24.8" data-path="week-13-lecture.html"><a href="week-13-lecture.html#model-selection-vs.-model-criticism"><i class="fa fa-check"></i><b>24.8</b> Model selection vs. model criticism</a></li>
<li class="chapter" data-level="24.9" data-path="week-13-lecture.html"><a href="week-13-lecture.html#comparing-two-models"><i class="fa fa-check"></i><b>24.9</b> Comparing two models</a>
<ul>
<li class="chapter" data-level="24.9.1" data-path="week-13-lecture.html"><a href="week-13-lecture.html#nested-or-not"><i class="fa fa-check"></i><b>24.9.1</b> Nested or not?</a></li>
<li class="chapter" data-level="24.9.2" data-path="week-13-lecture.html"><a href="week-13-lecture.html#likelihood-ratio-test-lrt"><i class="fa fa-check"></i><b>24.9.2</b> Likelihood Ratio Test (LRT)</a></li>
<li class="chapter" data-level="24.9.3" data-path="week-13-lecture.html"><a href="week-13-lecture.html#akaikes-information-criterion-aic"><i class="fa fa-check"></i><b>24.9.3</b> Akaike’s Information Criterion (AIC)</a></li>
<li class="chapter" data-level="24.9.4" data-path="week-13-lecture.html"><a href="week-13-lecture.html#bayesian-information-criterion-bic"><i class="fa fa-check"></i><b>24.9.4</b> Bayesian Information Criterion (BIC)</a></li>
<li class="chapter" data-level="24.9.5" data-path="week-13-lecture.html"><a href="week-13-lecture.html#comparing-lrt-and-aicbic"><i class="fa fa-check"></i><b>24.9.5</b> Comparing LRT and AIC/BIC</a></li>
</ul></li>
<li class="chapter" data-level="24.10" data-path="week-13-lecture.html"><a href="week-13-lecture.html#model-weighting"><i class="fa fa-check"></i><b>24.10</b> Model weighting</a></li>
<li class="chapter" data-level="24.11" data-path="week-13-lecture.html"><a href="week-13-lecture.html#stepwise-regression"><i class="fa fa-check"></i><b>24.11</b> Stepwise regression</a>
<ul>
<li class="chapter" data-level="24.11.1" data-path="week-13-lecture.html"><a href="week-13-lecture.html#criticism-of-stepwise-regression"><i class="fa fa-check"></i><b>24.11.1</b> Criticism of stepwise regression</a></li>
<li class="chapter" data-level="24.11.2" data-path="week-13-lecture.html"><a href="week-13-lecture.html#criticism-of-data-dredging"><i class="fa fa-check"></i><b>24.11.2</b> Criticism of data dredging</a></li>
<li class="chapter" data-level="24.11.3" data-path="week-13-lecture.html"><a href="week-13-lecture.html#final-thoughts-on-model-selection"><i class="fa fa-check"></i><b>24.11.3</b> Final thoughts on model selection</a></li>
</ul></li>
<li class="chapter" data-level="24.12" data-path="week-13-lecture.html"><a href="week-13-lecture.html#week-13-faq"><i class="fa fa-check"></i><b>24.12</b> Week 13 FAQ</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="week-13-lab.html"><a href="week-13-lab.html"><i class="fa fa-check"></i><b>25</b> Week 13 Lab</a>
<ul>
<li class="chapter" data-level="25.1" data-path="week-13-lab.html"><a href="week-13-lab.html#part-1-model-selection-model-comparison"><i class="fa fa-check"></i><b>25.1</b> Part 1: Model selection / model comparison</a></li>
<li class="chapter" data-level="25.2" data-path="week-13-lab.html"><a href="week-13-lab.html#model-selection-via-step-wise-regression"><i class="fa fa-check"></i><b>25.2</b> Model selection via step-wise regression</a></li>
<li class="chapter" data-level="25.3" data-path="week-13-lab.html"><a href="week-13-lab.html#part-2-model-criticism"><i class="fa fa-check"></i><b>25.3</b> Part 2: Model criticism</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="week-14-lecture.html"><a href="week-14-lecture.html"><i class="fa fa-check"></i><b>26</b> Week 14 Lecture</a>
<ul>
<li class="chapter" data-level="26.1" data-path="week-14-lecture.html"><a href="week-14-lecture.html#week-14-readings"><i class="fa fa-check"></i><b>26.1</b> Week 14 Readings</a></li>
<li class="chapter" data-level="26.2" data-path="week-14-lecture.html"><a href="week-14-lecture.html#what-does-multivariate-mean"><i class="fa fa-check"></i><b>26.2</b> What does ‘multivariate’ mean?</a></li>
<li class="chapter" data-level="26.3" data-path="week-14-lecture.html"><a href="week-14-lecture.html#multivariate-associations"><i class="fa fa-check"></i><b>26.3</b> Multivariate associations</a></li>
<li class="chapter" data-level="26.4" data-path="week-14-lecture.html"><a href="week-14-lecture.html#model-criticism-for-multivariate-analyses"><i class="fa fa-check"></i><b>26.4</b> Model criticism for multivariate analyses</a>
<ul>
<li class="chapter" data-level="26.4.1" data-path="week-14-lecture.html"><a href="week-14-lecture.html#transforming-your-data"><i class="fa fa-check"></i><b>26.4.1</b> Transforming your data</a></li>
</ul></li>
<li class="chapter" data-level="26.5" data-path="week-14-lecture.html"><a href="week-14-lecture.html#standardizing-your-data"><i class="fa fa-check"></i><b>26.5</b> Standardizing your data</a></li>
<li class="chapter" data-level="26.6" data-path="week-14-lecture.html"><a href="week-14-lecture.html#multivariate-outliers"><i class="fa fa-check"></i><b>26.6</b> Multivariate outliers</a></li>
<li class="chapter" data-level="26.7" data-path="week-14-lecture.html"><a href="week-14-lecture.html#brief-overview-of-multivariate-analyses"><i class="fa fa-check"></i><b>26.7</b> Brief overview of multivariate analyses</a></li>
<li class="chapter" data-level="26.8" data-path="week-14-lecture.html"><a href="week-14-lecture.html#manova-and-dfa"><i class="fa fa-check"></i><b>26.8</b> MANOVA and DFA</a></li>
<li class="chapter" data-level="26.9" data-path="week-14-lecture.html"><a href="week-14-lecture.html#scaling-or-ordination-techniques"><i class="fa fa-check"></i><b>26.9</b> Scaling or ordination techniques</a></li>
<li class="chapter" data-level="26.10" data-path="week-14-lecture.html"><a href="week-14-lecture.html#principal-components-analysis-pca"><i class="fa fa-check"></i><b>26.10</b> Principal components analysis (PCA)</a></li>
<li class="chapter" data-level="26.11" data-path="week-14-lecture.html"><a href="week-14-lecture.html#principal-components-analysis-pca-1"><i class="fa fa-check"></i><b>26.11</b> Principal components analysis (PCA)</a></li>
<li class="chapter" data-level="26.12" data-path="week-14-lecture.html"><a href="week-14-lecture.html#pca-in-r"><i class="fa fa-check"></i><b>26.12</b> PCA in R</a></li>
<li class="chapter" data-level="26.13" data-path="week-14-lecture.html"><a href="week-14-lecture.html#missing-data"><i class="fa fa-check"></i><b>26.13</b> Missing data</a></li>
<li class="chapter" data-level="26.14" data-path="week-14-lecture.html"><a href="week-14-lecture.html#imputing-missing-data"><i class="fa fa-check"></i><b>26.14</b> Imputing missing data</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="week-14-lab.html"><a href="week-14-lab.html"><i class="fa fa-check"></i><b>27</b> Week 14 Lab</a>
<ul>
<li class="chapter" data-level="27.1" data-path="week-14-lab.html"><a href="week-14-lab.html#missing-at-random---practice-with-glms"><i class="fa fa-check"></i><b>27.1</b> Missing at random - practice with GLMs</a></li>
<li class="chapter" data-level="27.2" data-path="week-14-lab.html"><a href="week-14-lab.html#finally-a-word-about-grades"><i class="fa fa-check"></i><b>27.2</b> Finally, a word about grades</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Biometry Lecture and Lab Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="week-5-lab" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">10</span> Week 5 Lab<a href="week-5-lab.html#week-5-lab" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="t-test" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> t-test<a href="week-5-lab.html#t-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To learn more about R`s functions for doing the hypothesis tests introduced on Tuesday, we will simulate some data. Simulating data with known properties is always the best way of exploring a statistical test before applying it to your own data. Although we could simulate data using the “rnorm” function, we will use the “mvrnorm” function from the MASS package so we can consider the role of correlation between the two samples.</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="week-5-lab.html#cb254-1" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb254-2"><a href="week-5-lab.html#cb254-2" tabindex="-1"></a>data<span class="ot">&lt;-</span><span class="fu">mvrnorm</span>(<span class="at">n=</span><span class="dv">100</span>,<span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">1.2</span>),<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>),<span class="dv">2</span>,<span class="dv">2</span>))</span></code></pre></div>
<p>The call here is similar to the one used for rnorm except now we are drawing two samples at the same time with the following properties:</p>
<p><span class="math display">\[
\left[ \begin{array}{c}
X_{A}  \\
X_{B}  \end{array} \right] \sim N\left(\left(\begin{array}{c}
\mu_{A}  \\
\mu_{B}  \end{array}\right),\left(\begin{array}{cc}
Cov(A,A) &amp; Cov(A,B)   \\
Cov(A,B) &amp; Cov(B,B) \end{array}\right)\right)
\]</span></p>
<p>Note that the variances have to be non-negative, and because Cov(A,B)=Cov(B,A), the covariance matrix has to be symmetric. (CAREFUL: mvrnorm does not enforce this!)</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="week-5-lab.html#cb255-1" tabindex="-1"></a>sample.a<span class="ot">&lt;-</span>data[,<span class="dv">1</span>]</span>
<span id="cb255-2"><a href="week-5-lab.html#cb255-2" tabindex="-1"></a>sample.b<span class="ot">&lt;-</span>data[,<span class="dv">2</span>]</span>
<span id="cb255-3"><a href="week-5-lab.html#cb255-3" tabindex="-1"></a><span class="fu">plot</span>(sample.a,sample.b)</span></code></pre></div>
<p><img src="Week-5-lab_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>Notice that because Cov<span class="math inline">\((X_{A},X_{B})\)</span>=0, the scatterplot has no trend.</p>
<p>The t-test will answer the question, “Can we reject the null hypothesis that these two populations have the same mean”?</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="week-5-lab.html#cb256-1" tabindex="-1"></a><span class="fu">t.test</span>(sample.a,sample.b)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  sample.a and sample.b
## t = 0.7491, df = 197.81, p-value = 0.4547
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.3108335  0.6916329
## sample estimates:
## mean of x mean of y 
## 1.1667366 0.9763369</code></pre>
<p>Notice that the degrees of freedom need not necessarily be an integer. R assumes unequal variances so we have to use the more complicated formula for the degrees of freedom. (In this situation, the number of degrees of freedom is not very intuitive; however, if you have <span class="math inline">\(s_{A}^{2}=s_{B}^{2}\)</span> and <span class="math inline">\(n_{A}=n_{B}\)</span>, then the formula for the d.o.f. simplifies to 2n-2 which is what you would expect. )</p>
<p>Because we are simulating data, everyone’s output is going to look slightly different. In fact, some of us may get p&lt;0.05 and others p&gt;0.05. Here we are looking for a relatively small difference (compared to the standard deviations) with only 100 random draws. We would get more consistent results if we had larger sample sizes, larger mean differences, or smaller standard deviations.</p>
<p><strong><span style="color: green;">Checkpoint #1: The output of t.test includes 7 quantities - can you reproduce all 7 quantities based on what we learned on Tuesday?</span></strong></p>
<p>The default in R is to assume a two-sided test. In other words, by default, R tests</p>
<p><span class="math display">\[
H_{0}:\mu_{1}=\mu_{2},                                                
H_{A}:\mu_{1}\neq\mu_{2}
\]</span></p>
<p>The lower limit of the two-sided 95th percentile CI represents the quantile below which 2.5<span class="math inline">\(\%\)</span> of the probability falls and vice versa. However, when we are thinking about a one-tailed test, we would put all 5<span class="math inline">\(\%\)</span> in one tail and then we would reject all test statistics that fall inside this one tail. If we are estimating effect sizes and their confidence intervals, the confidence intervals are no longer bounded on both sides. In fact, for a one-tailed test where we are only interested in the “greater” alternative hypothesis (for example, <span class="math inline">\(X_{A}&gt;X_{B}\)</span>), there is only a lower bound (the upper bound is infinity) because the question then becomes whether the smallest value of the test statistic consistent with the data is below zero (in which case you cannot reject the null hypothesis and the difference is not significant) or above zero (in which case the values consistent with the data are <em>all</em> above zero and therefore you can reject the null hypothesis). In other words, when you are only interested in the alternative hypotheses <span class="math inline">\(X_{A}&gt;X_{B}\)</span>, you don’t care <em>how</em> much bigger <span class="math inline">\(X_{A}\)</span> is than <span class="math inline">\(X_{B}\)</span>, you just want to know whether <em>at its smallest</em> the difference is still larger than zero.</p>
<p>You can force R to do a one-sided test, either</p>
<p><span class="math display">\[
H_{A}:\mu_{1}&gt;\mu_{2}
\]</span></p>
<p>or</p>
<p><span class="math display">\[
H_{A}:\mu_{1}&lt;\mu_{2}
\]</span></p>
<p>by using the options</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="week-5-lab.html#cb258-1" tabindex="-1"></a><span class="fu">t.test</span>(sample.a,sample.b,<span class="at">alternative=</span><span class="st">&quot;greater&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  sample.a and sample.b
## t = 0.7491, df = 197.81, p-value = 0.2273
## alternative hypothesis: true difference in means is greater than 0
## 95 percent confidence interval:
##  -0.2296421        Inf
## sample estimates:
## mean of x mean of y 
## 1.1667366 0.9763369</code></pre>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="week-5-lab.html#cb260-1" tabindex="-1"></a><span class="fu">t.test</span>(sample.a,sample.b,<span class="at">alternative=</span><span class="st">&quot;less&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  sample.a and sample.b
## t = 0.7491, df = 197.81, p-value = 0.7727
## alternative hypothesis: true difference in means is less than 0
## 95 percent confidence interval:
##       -Inf 0.6104415
## sample estimates:
## mean of x mean of y 
## 1.1667366 0.9763369</code></pre>
<p>Try both of these options and see how the p-value and the confidence intervals change. Make sure you understand why they make sense. Remember, if you are going to use a one-tailed test, you should be prepared to accept that a large difference opposite to what was expected is pure random chance.</p>
<p>Spend some time going back and experimenting with different sets of random variables. Make the means more or less different. Change the variances. Make sure you understand why the t-test results change as you alter the data. <strong><span style="color: green;">Checkpoint #2: What happens if you make the sample sizes smaller or larger?</span></strong></p>
<p>Now let’s see what happens when we simulate a new dataset with correlations between the two samples.</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="week-5-lab.html#cb262-1" tabindex="-1"></a>data<span class="ot">&lt;-</span><span class="fu">mvrnorm</span>(<span class="at">n=</span><span class="dv">100</span>,<span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">1.2</span>),<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb262-2"><a href="week-5-lab.html#cb262-2" tabindex="-1"></a>sample.a<span class="ot">&lt;-</span>data[,<span class="dv">1</span>]</span>
<span id="cb262-3"><a href="week-5-lab.html#cb262-3" tabindex="-1"></a>sample.b<span class="ot">&lt;-</span>data[,<span class="dv">2</span>]</span>
<span id="cb262-4"><a href="week-5-lab.html#cb262-4" tabindex="-1"></a><span class="fu">plot</span>(sample.a,sample.b)</span></code></pre></div>
<p><img src="Week-5-lab_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>Notice that now the two samples are positively correlated.</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="week-5-lab.html#cb263-1" tabindex="-1"></a><span class="fu">t.test</span>(sample.a,sample.b,<span class="at">paired=</span>T)</span></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  sample.a and sample.b
## t = -0.70233, df = 99, p-value = 0.4841
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.3420054  0.1631881
## sample estimates:
## mean of the differences 
##             -0.08940864</code></pre>
<p>Compare this with</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="week-5-lab.html#cb265-1" tabindex="-1"></a><span class="fu">t.test</span>(sample.a,sample.b,<span class="at">paired=</span>F)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  sample.a and sample.b
## t = -0.37918, df = 194.87, p-value = 0.705
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.5544505  0.3756332
## sample estimates:
## mean of x mean of y 
##  1.166717  1.256126</code></pre>
<p>which is the same as</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="week-5-lab.html#cb267-1" tabindex="-1"></a><span class="fu">t.test</span>(sample.a,sample.b)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  sample.a and sample.b
## t = -0.37918, df = 194.87, p-value = 0.705
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.5544505  0.3756332
## sample estimates:
## mean of x mean of y 
##  1.166717  1.256126</code></pre>
<p>since the default is to assume unpaired samples.</p>
<p>To convince ourselves of the formulas we learned for paired t-tests, we will define a new variable</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="week-5-lab.html#cb269-1" tabindex="-1"></a>z<span class="ot">&lt;-</span>sample.a<span class="sc">-</span>sample.b</span>
<span id="cb269-2"><a href="week-5-lab.html#cb269-2" tabindex="-1"></a><span class="fu">mean</span>(z)</span></code></pre></div>
<pre><code>## [1] -0.08940864</code></pre>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="week-5-lab.html#cb271-1" tabindex="-1"></a><span class="fu">var</span>(z)</span></code></pre></div>
<pre><code>## [1] 1.620605</code></pre>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="week-5-lab.html#cb273-1" tabindex="-1"></a><span class="fu">var</span>(sample.a)<span class="sc">+</span><span class="fu">var</span>(sample.b)<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">cov</span>(sample.a,sample.b)</span></code></pre></div>
<pre><code>## [1] 1.620605</code></pre>
<p>Spend some time going back and experimenting with different sets of random variables. In particular, change the covariances (makign sure that the covariance matrix is symmetric and the variances positive). Make sure you understand why the t-test results change as you alter the data. <strong><span style="color: green;">Checkpoint #3: What happens to the t-test results when you make the correlation weak?</span></strong></p>
</div>
<div id="f-test" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> F-test<a href="week-5-lab.html#f-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>One of the conditions for using the t-test is that the variances of the two samples are the same. One way of determining if the two variances are the same is the F-test. To review what we learned on Tuesday, under the null hypothesis that two populations have the same <span class="math inline">\(\sigma^{2}\)</span>, the ratio of their sample variances will follow an F-distribution</p>
<p><span class="math display">\[
F_{s}=\frac{s_{A}^{2}}{s_{B}^{2}}
\]</span></p>
<p>If the value of the test statistic would be unusual for the F-distribution, we would reject the null hypothesis. (In other words, such a ratio of variances would be unlikely to occur by chance if the two variances were in fact the same.)</p>
<p>As with the t-test, we can do a one-tailed or two-tailed F-test. The one-tailed F-test presumes that we want to test whether one variance is significantly larger than another variance, i.e.</p>
<p><span class="math display">\[
H_{0}: \sigma_{A}^{2} = \sigma_{B}^{2}
\]</span></p>
<p><span class="math display">\[
H_{\mbox{A implied}}: \sigma_{A}^{2} &gt; \sigma_{B}^{2}
\]</span></p>
<p>For a one-tailed test, we would assume that if the data were to show that</p>
<p><span class="math display">\[
s_{B}^{2} &gt; s_{A}^{2}
\]</span></p>
<p>then we would chalk that up to random chance and we would NOT interpret that as</p>
<p><span class="math display">\[
\sigma_{B}^{2} &gt; \sigma_{A}^{2}.
\]</span></p>
<p>If we are doing a one-tailed F-test where we are <em>only</em> interested in <span class="math inline">\(\sigma_{A}^{2} &gt; \sigma_{B}^{2}\)</span>, then our test statistic is <span class="math inline">\(\frac{s_{A}^{2}}{s_{B}^{2}}\)</span> (regardless of which is bigger), and we would set our critical value so that <span class="math inline">\(\alpha\)</span> of the distribution of the test statistic would fall into the right-hand tail of the F-distribution. We would then compare our test statistic <span class="math inline">\(T^{*}\)</span> to the value of the (1-<span class="math inline">\(\alpha\)</span>) quantile of the F-distribution, and the question becomes</p>
<p><span class="math display">\[
\frac{s_{A}^{2}}{s_{B}^{2}} &gt; F_{[1-\alpha](n-1,m-1)}?
\]</span></p>
<p>However, if we are open to either</p>
<p><span class="math display">\[
H_{\mbox{A implied}}: \sigma_{A}^{2} &gt; \sigma_{B}^{2}
\]</span></p>
<p>or</p>
<p><span class="math display">\[
H_{\mbox{A implied}}: \sigma_{A}^{2} &lt; \sigma_{B}^{2}
\]</span></p>
<p>then we want to do a two-tailed test. In this case, by tradition and to make life simpler, the larger sample variance always goes in the numerator, and we check this value against the critical value obtained by putting only 2.5% in the right hand tail. Now we are asking the question</p>
<p><span class="math display">\[
\frac{s_{A}^{2}}{s_{B}^{2}} &gt; F_{[1-\frac{\alpha}{2}](n-1,m-1)}?
\]</span></p>
<p>In other words, because the F-distribution is always non-negative, it is easier to put the larger sample variance in the numerator to create a test statistic <span class="math inline">\(T^{*}&gt;1\)</span> and then compare that to <span class="math inline">\(F_{[1-\frac{\alpha}{2}](n-1,m-1)}\)</span> than it is to worry about computing both critical values (one for a ratio <span class="math inline">\(&lt;1\)</span> and a separate one for a ratio <span class="math inline">\(&gt;1\)</span>).</p>
<p>Let’s explore this by simulating some data</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="week-5-lab.html#cb275-1" tabindex="-1"></a>sample.a<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">100</span>,<span class="at">mean=</span><span class="dv">5</span>,<span class="at">sd=</span><span class="dv">4</span>)</span>
<span id="cb275-2"><a href="week-5-lab.html#cb275-2" tabindex="-1"></a>sample.b<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">100</span>,<span class="at">mean=</span><span class="dv">2</span>,<span class="at">sd=</span><span class="dv">3</span>)</span></code></pre></div>
<p>Lets assume we are only interested in the implied alternative hypothesis</p>
<p><span class="math display">\[
H_{A implied}: \sigma_{A}^{2} &gt; \sigma_{B}^{2}
\]</span></p>
<p>We can calculate this one-tailed F-test by hand first</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="week-5-lab.html#cb276-1" tabindex="-1"></a>var.A<span class="ot">&lt;-</span><span class="fu">var</span>(sample.a)</span>
<span id="cb276-2"><a href="week-5-lab.html#cb276-2" tabindex="-1"></a>var.B<span class="ot">&lt;-</span><span class="fu">var</span>(sample.b)</span>
<span id="cb276-3"><a href="week-5-lab.html#cb276-3" tabindex="-1"></a>F.ratio<span class="ot">&lt;-</span>var.A<span class="sc">/</span>var.B </span>
<span id="cb276-4"><a href="week-5-lab.html#cb276-4" tabindex="-1"></a>F.ratio</span></code></pre></div>
<pre><code>## [1] 1.73414</code></pre>
<p>Note that we didn’t check that var.A was actually bigger than var.B. Because we are only interested in a one-tailed test, we want var.A in the numerator and we will compare that to the right-hand side of the F-distribution.</p>
<p>Now we know what the F-ratio of our simulated data is, but we don’t know what the critical value of the test statistic is for the ratio to be considered “significant”.</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="week-5-lab.html#cb278-1" tabindex="-1"></a><span class="fu">qf</span>(<span class="at">p=</span><span class="fl">0.95</span>,<span class="at">df1=</span><span class="dv">99</span>,<span class="at">df2=</span><span class="dv">99</span>)</span></code></pre></div>
<pre><code>## [1] 1.394061</code></pre>
<p><strong><span style="color: green;">Checkpoint #4: Do you understand why df1=99 and df2=99?</span></strong></p>
<p>We see that the F-ratio for our data is greater than the critical value for the 95th percentile. Therefore we can say that the two samples are unlikely to come from populations from the same variance. We can also flip the question around to ask: “What is the probability of obtaining this F-ratio if the null hypothesis were true?”</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="week-5-lab.html#cb280-1" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pf</span>(F.ratio,<span class="at">df1=</span><span class="dv">99</span>,<span class="at">df2=</span><span class="dv">99</span>)</span></code></pre></div>
<pre><code>## [1] 0.003314422</code></pre>
<p>and we see that it is small (&lt;0.05).</p>
<p>Remember, pf gives the cumulative probability of getting any value less than or equal to the percentile being queried, so 1-pf gives the probability of getting a value as or more extreme.</p>
<p>R gives us an easier way to test equality of variances (the F test):</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="week-5-lab.html#cb282-1" tabindex="-1"></a><span class="fu">var.test</span>(sample.a,sample.b)</span></code></pre></div>
<pre><code>## 
##  F test to compare two variances
## 
## data:  sample.a and sample.b
## F = 1.7341, num df = 99, denom df = 99, p-value = 0.006629
## alternative hypothesis: true ratio of variances is not equal to 1
## 95 percent confidence interval:
##  1.166802 2.577338
## sample estimates:
## ratio of variances 
##            1.73414</code></pre>
<p>The output of var.test includes 7 quantities - make sure you can calculate each and every one of these quantities.</p>
<p>How did R arrive at its p-value? Notice that it is twice what we calculated when doing the F-test by hand. The reason is that R’s default is to do a two-sided test, and we only calculated the probability that you got a ratio as big or larger than the <span class="math inline">\(F^{*}\)</span>. You can get the two-tailed probability by either doubling that value or by adding the probability that you would get an F-ratio smaller than 1/<span class="math inline">\(F^{*}\)</span>.</p>
<p>Notice also that to get the confidence intervals on the F-ratio, you multiply by the quantiles of the F-distribution.</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="week-5-lab.html#cb284-1" tabindex="-1"></a><span class="fu">qf</span>(<span class="fl">0.025</span>,<span class="at">df1=</span><span class="dv">99</span>,<span class="at">df2=</span><span class="dv">99</span>)<span class="sc">*</span>F.ratio</span></code></pre></div>
<pre><code>## [1] 1.166802</code></pre>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="week-5-lab.html#cb286-1" tabindex="-1"></a><span class="fu">qf</span>(<span class="fl">0.975</span>,<span class="at">df1=</span><span class="dv">99</span>,<span class="at">df2=</span><span class="dv">99</span>)<span class="sc">*</span>F.ratio</span></code></pre></div>
<pre><code>## [1] 2.577338</code></pre>
</div>
<div id="comparing-two-proportions-1" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> Comparing two proportions<a href="week-5-lab.html#comparing-two-proportions-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>On Tuesday I introduced two different test statistics that are frequently used to test a binomial proportion.</p>
<p>The Wald test is based on the idea that near the minimum of the likelihood function (in the vicinity of the MLE), deviations from the MLE will be normally distributed. Therefore, the Wald test is a very general statement</p>
<p><span class="math display">\[
\frac{\hat{\theta}-\theta_{0}}{se(\hat{\theta})}\sim N(0,1)
\]</span></p>
<p>which we can apply in this specific case as</p>
<p><span class="math display">\[
\frac{\hat{p}-\theta_{0}}{\sqrt{\frac{\hat{p}(1-\hat{p})}{n}}}\sim N(0,1)
\]</span></p>
<p>The ‘score’ test uses the value of the binomial proportion <em>under the null hypothesis</em> in place of the empirical probability in estimating the standard error in the denominator.</p>
<p><span class="math display">\[
\frac{\hat{p}-\theta_{0}}{\sqrt{\frac{\theta_{0}(1-\theta_{0})}{n}}}\sim N(0,1)
\]</span></p>
<p>We can easily invert the Wald test to arrive at the following confidence interval for p:</p>
<p><span class="math display">\[
P\left(\hat{p}-z_{1-(\alpha/2)}\sqrt{\frac{\hat{p}(1-\hat{p})}{n}}\leq \theta \leq \hat{p}+z_{1-(\alpha/2)}\sqrt{\frac{\hat{p}(1-\hat{p})}{n}}\right)=1-\alpha
\]</span></p>
<p>However, if you look at the score test, you see that it is quite difficult to invert and isolate <span class="math inline">\(\hat{p}\)</span>. This is why the confidence intervals for the score test are so complicated. We will not go into more detail here because in practice you would not be calculating it by hand anyways (but the general idea behind inverting the test to get a CI should be clear!).</p>
<p>We will now explore R’s functions for estimating the probability <span class="math inline">\(\hat{p}\)</span> (and its confidence interval) for a binomial distribution.</p>
<p>First we simulate some data to work with</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="week-5-lab.html#cb288-1" tabindex="-1"></a>heads<span class="ot">&lt;-</span><span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="at">size=</span><span class="dv">100</span>,<span class="at">prob=</span><span class="fl">0.5</span>)</span>
<span id="cb288-2"><a href="week-5-lab.html#cb288-2" tabindex="-1"></a>heads</span></code></pre></div>
<pre><code>## [1] 49</code></pre>
<p>Now we will use R’s function for the proportion test</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="week-5-lab.html#cb290-1" tabindex="-1"></a><span class="fu">prop.test</span>(heads,<span class="dv">100</span>) <span class="co">#continuity correction true by default</span></span></code></pre></div>
<pre><code>## 
##  1-sample proportions test with continuity correction
## 
## data:  heads out of 100, null probability 0.5
## X-squared = 0.01, df = 1, p-value = 0.9203
## alternative hypothesis: true p is not equal to 0.5
## 95 percent confidence interval:
##  0.3894281 0.5913488
## sample estimates:
##    p 
## 0.49</code></pre>
<p>The continuity correction is used because we are approximating a discrete distribution (the binomial) with its normal approximation. While generally recommended, it rarely makes a large difference and for transparency I suggest we turn it off.</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="week-5-lab.html#cb292-1" tabindex="-1"></a><span class="fu">prop.test</span>(heads,<span class="dv">100</span>,<span class="at">correct=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## 
##  1-sample proportions test without continuity correction
## 
## data:  heads out of 100, null probability 0.5
## X-squared = 0.04, df = 1, p-value = 0.8415
## alternative hypothesis: true p is not equal to 0.5
## 95 percent confidence interval:
##  0.3942200 0.5865199
## sample estimates:
##    p 
## 0.49</code></pre>
<p>To make sure we understand this, let’s look at the help file for prop.test</p>
<pre><code>?prop.test</code></pre>
<p>There are a couple of additional pieces of information you need to understand and/or reconstruct the output for prop.test, and unfortunately the help file for this function is fairly unhelpful.</p>
<ul>
<li>R uses the <strong>score test</strong>, so the confidence interval computed by R won’t be quite the same as what we would calculate using the Wald test method introduced in lecture. (But they will be close.)</li>
<li>The test statistic that prop.test reports is the square of the score test statistic introduced in lecture</li>
</ul>
<p><span class="math display">\[
\left[\frac{\hat{p}-\theta_{0}}{\sqrt{\frac{\theta_{0}(1-\theta_{0})}{n}}}\right]^{2}
\]</span></p>
<p>This is fine. Remember that there is no “correct” test statistic. The only challenge here is that we need to find the distribution of the test statistic under the null hypothesis. In this case, we remember from Week 3 that if we have a random variable X</p>
<p><span class="math display">\[
X \sim N(0,1)
\]</span></p>
<p>then the square of X</p>
<p><span class="math display">\[
X^{2} \sim \chi^{2}_{1}
\]</span></p>
<p>Therefore, the test statistic output by prop.test (assuming <span class="math inline">\(H_{0}: \theta_{0}=0.5\)</span>) is</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="week-5-lab.html#cb295-1" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb295-2"><a href="week-5-lab.html#cb295-2" tabindex="-1"></a>theta0<span class="ot">&lt;-</span><span class="fl">0.5</span></span>
<span id="cb295-3"><a href="week-5-lab.html#cb295-3" tabindex="-1"></a>test.statistic<span class="ot">&lt;-</span>(((heads<span class="sc">/</span>n)<span class="sc">-</span>theta0)<span class="sc">/</span>(<span class="fu">sqrt</span>(theta0<span class="sc">*</span>theta0<span class="sc">/</span>n)))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb295-4"><a href="week-5-lab.html#cb295-4" tabindex="-1"></a>test.statistic</span></code></pre></div>
<pre><code>## [1] 0.04</code></pre>
<p>and the p-value is given by</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="week-5-lab.html#cb297-1" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(test.statistic,<span class="at">df=</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.8414806</code></pre>
<p>Notice that because <span class="math inline">\(X^{2}\)</span> is always positive, the test is a one-tailed test (“extreme” values of this test statistic are always large and <strong>positive</strong>). We could get the same result comparing the original (non-squared) test statistic against the Standard Normal, as long as you make sure to do the two-tailed test (“extreme” for X includes large and positive <strong>and</strong> large and negative).</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="week-5-lab.html#cb299-1" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="fu">sqrt</span>(test.statistic)))</span></code></pre></div>
<pre><code>## [1] 0.8414806</code></pre>
<ul>
<li>Notice in the helpfile that R will return a clipped version of the confidence interval, so the confidence interval is bounded [0,1].</li>
</ul>
<p>There is another function in R called “binom.test” which does an “exact test” based on the actual binomial distribution, rather than the normal approximation to it we introduced on Tuesday. Notice that there is no continuity correction because we are not approximating the binomial distribution with the normal distribution.</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="week-5-lab.html#cb301-1" tabindex="-1"></a><span class="fu">binom.test</span>(heads,<span class="dv">100</span>)</span></code></pre></div>
<pre><code>## 
##  Exact binomial test
## 
## data:  heads and 100
## number of successes = 49, number of trials = 100, p-value = 0.9204
## alternative hypothesis: true probability of success is not equal to 0.5
## 95 percent confidence interval:
##  0.3886442 0.5919637
## sample estimates:
## probability of success 
##                   0.49</code></pre>
<p>One of the caveats in using the Wald method for binomial proportion is that it can give unrealistic values for the CIs when the underlying probability is very close to either 0 or 1 (especially if the sample size is small).</p>
<p>To see this, lets calculate the Wald confidence intervals by hand assuming we got 2 successes out of 100 trials.</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="week-5-lab.html#cb303-1" tabindex="-1"></a>p.hat<span class="ot">&lt;-</span><span class="dv">2</span><span class="sc">/</span><span class="dv">100</span></span>
<span id="cb303-2"><a href="week-5-lab.html#cb303-2" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb303-3"><a href="week-5-lab.html#cb303-3" tabindex="-1"></a>se<span class="ot">&lt;-</span><span class="fu">sqrt</span>(p.hat<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p.hat)<span class="sc">/</span>n)</span>
<span id="cb303-4"><a href="week-5-lab.html#cb303-4" tabindex="-1"></a>z<span class="ot">&lt;-</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>)</span>
<span id="cb303-5"><a href="week-5-lab.html#cb303-5" tabindex="-1"></a>LL<span class="ot">&lt;-</span>p.hat<span class="sc">-</span>se<span class="sc">*</span>z</span>
<span id="cb303-6"><a href="week-5-lab.html#cb303-6" tabindex="-1"></a>UL<span class="ot">&lt;-</span>p.hat<span class="sc">+</span>se<span class="sc">*</span>z</span>
<span id="cb303-7"><a href="week-5-lab.html#cb303-7" tabindex="-1"></a>LL</span></code></pre></div>
<pre><code>## [1] -0.007439496</code></pre>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="week-5-lab.html#cb305-1" tabindex="-1"></a>UL</span></code></pre></div>
<pre><code>## [1] 0.0474395</code></pre>
<p>The lower limit of the CI is actually negative which makes no sense since the binomial proportion is bounded [0,1]. We can clip the CI to have a LL of zero, but there is no guarentee that the “coverage” of the CI contains 95%. To see whether this is true, lets simulate multiple datasets with a true underlying probability of 0.02, calculate confidence intervals from those random samples, and see what proportion of the CIs actually contain the true value (0.02).</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="week-5-lab.html#cb307-1" tabindex="-1"></a>data<span class="ot">&lt;-</span><span class="fu">rbinom</span>(<span class="at">n=</span><span class="dv">1000</span>,<span class="at">size=</span><span class="dv">100</span>,<span class="at">prob=</span><span class="fl">0.02</span>) <span class="co">#draw 1000 random datasets-100 trials each</span></span>
<span id="cb307-2"><a href="week-5-lab.html#cb307-2" tabindex="-1"></a>p.hat<span class="ot">&lt;-</span>data<span class="sc">/</span><span class="dv">100</span> <span class="co">#vector of empirical probabilities p.hat</span></span>
<span id="cb307-3"><a href="week-5-lab.html#cb307-3" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb307-4"><a href="week-5-lab.html#cb307-4" tabindex="-1"></a>se<span class="ot">&lt;-</span><span class="fu">sqrt</span>(p.hat<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p.hat)<span class="sc">/</span>n)</span>
<span id="cb307-5"><a href="week-5-lab.html#cb307-5" tabindex="-1"></a>z<span class="ot">&lt;-</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>)</span>
<span id="cb307-6"><a href="week-5-lab.html#cb307-6" tabindex="-1"></a>LL<span class="ot">&lt;-</span>p.hat<span class="sc">-</span>se<span class="sc">*</span>z <span class="co">#vector of LLs</span></span>
<span id="cb307-7"><a href="week-5-lab.html#cb307-7" tabindex="-1"></a>UL<span class="ot">&lt;-</span>p.hat<span class="sc">+</span>se<span class="sc">*</span>z <span class="co">#vector of UL</span></span>
<span id="cb307-8"><a href="week-5-lab.html#cb307-8" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">as.numeric</span>((<span class="fl">0.02</span><span class="sc">&lt;=</span>UL)<span class="sc">&amp;</span>(<span class="fl">0.02</span><span class="sc">&gt;=</span>LL)))<span class="sc">/</span><span class="dv">1000</span> <span class="co">#proportion of times the CI include the true value</span></span></code></pre></div>
<pre><code>## [1] 0.882</code></pre>
<p>We see that the CIs are actually too narrow! The Wald test is commonly used but as we have demonstrated, it is not very good in practice. R and its packages make it easy to get better CIs for a binomial proportion and in real analysis, you should use these more sophisticated methods.</p>
<p>One of the better functions for doing tests of binomial proportions is provided by Dr. Dirk Enzmann. He has posted a function online that calculates 11 different versions of the binomial confidence interval.</p>
<p>I have pasted the function here:</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="week-5-lab.html#cb309-1" tabindex="-1"></a><span class="co"># Calculate confidence intervals for a single proportion according to one of 11</span></span>
<span id="cb309-2"><a href="week-5-lab.html#cb309-2" tabindex="-1"></a><span class="co"># methods (default: log likelihood ratio) for a level of alpha (default: .05)</span></span>
<span id="cb309-3"><a href="week-5-lab.html#cb309-3" tabindex="-1"></a><span class="co"># and with significant decimals (default: 3) given a proportion and the sample</span></span>
<span id="cb309-4"><a href="week-5-lab.html#cb309-4" tabindex="-1"></a><span class="co"># size (see: Newcombe, 1998; Brown et al., 2001). Except for the asymptotic and</span></span>
<span id="cb309-5"><a href="week-5-lab.html#cb309-5" tabindex="-1"></a><span class="co"># Agresti&#39;s methods all methods can yield asymmetric intervals around p:</span></span>
<span id="cb309-6"><a href="week-5-lab.html#cb309-6" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb309-7"><a href="week-5-lab.html#cb309-7" tabindex="-1"></a><span class="co"># Methods are:</span></span>
<span id="cb309-8"><a href="week-5-lab.html#cb309-8" tabindex="-1"></a><span class="co"># &#39;likelihood&#39;    : log likelihood ratio interval (default)</span></span>
<span id="cb309-9"><a href="week-5-lab.html#cb309-9" tabindex="-1"></a><span class="co"># &#39;asymptotic&#39;    : simple &quot;classical text book&quot; or Wald method interval</span></span>
<span id="cb309-10"><a href="week-5-lab.html#cb309-10" tabindex="-1"></a><span class="co"># &#39;asymptotic.cc  : asymptotic with Yates&#39; continuity correction</span></span>
<span id="cb309-11"><a href="week-5-lab.html#cb309-11" tabindex="-1"></a><span class="co"># &#39;score&#39;         : score or Wilson method interval (= prop.test(...,correct=F),</span></span>
<span id="cb309-12"><a href="week-5-lab.html#cb309-12" tabindex="-1"></a><span class="co">#                   i.e. without Yates&#39; continuity correction)</span></span>
<span id="cb309-13"><a href="week-5-lab.html#cb309-13" tabindex="-1"></a><span class="co"># &#39;score.cc&#39;      : score method with continuity correction (= default of</span></span>
<span id="cb309-14"><a href="week-5-lab.html#cb309-14" tabindex="-1"></a><span class="co">#                   prop.test())</span></span>
<span id="cb309-15"><a href="week-5-lab.html#cb309-15" tabindex="-1"></a><span class="co"># &#39;binomial&#39;      : &quot;exact&quot; or Clopper-Pearson method interval (= binom.test())</span></span>
<span id="cb309-16"><a href="week-5-lab.html#cb309-16" tabindex="-1"></a><span class="co"># &#39;binomial.midp&#39; : binomial mid-p &quot;quasi-exact&quot; interval</span></span>
<span id="cb309-17"><a href="week-5-lab.html#cb309-17" tabindex="-1"></a><span class="co"># &#39;Jeffreys&#39;      : Jeffreys prior interval</span></span>
<span id="cb309-18"><a href="week-5-lab.html#cb309-18" tabindex="-1"></a><span class="co"># &#39;Agresti-Coull&#39; : Agresti-Coull method adding z?/2 successes</span></span>
<span id="cb309-19"><a href="week-5-lab.html#cb309-19" tabindex="-1"></a><span class="co"># &#39;Agresti.2_2    : Agresti-Coull method adding 2 successes and 2 failures</span></span>
<span id="cb309-20"><a href="week-5-lab.html#cb309-20" tabindex="-1"></a><span class="co"># &#39;logit&#39;         : logit interval</span></span>
<span id="cb309-21"><a href="week-5-lab.html#cb309-21" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb309-22"><a href="week-5-lab.html#cb309-22" tabindex="-1"></a><span class="co"># References:</span></span>
<span id="cb309-23"><a href="week-5-lab.html#cb309-23" tabindex="-1"></a><span class="co"># Brown, L.D., Cai, T.T. &amp; DasGupta, A. (2001). Interval estimation for a</span></span>
<span id="cb309-24"><a href="week-5-lab.html#cb309-24" tabindex="-1"></a><span class="co">#    binomial proportion. Statistical Science, 16, 101-133.</span></span>
<span id="cb309-25"><a href="week-5-lab.html#cb309-25" tabindex="-1"></a><span class="co"># Newcombe, R.G. (1998). Two-sided confidence intervals for the single propor-</span></span>
<span id="cb309-26"><a href="week-5-lab.html#cb309-26" tabindex="-1"></a><span class="co">#    tion: Comparison of seven methods. Statistics in Medicine, 17, 857-872.</span></span>
<span id="cb309-27"><a href="week-5-lab.html#cb309-27" tabindex="-1"></a></span>
<span id="cb309-28"><a href="week-5-lab.html#cb309-28" tabindex="-1"></a>prop.CI <span class="ot">=</span> <span class="cf">function</span>(p,n,<span class="at">alpha=</span>.<span class="dv">05</span>,<span class="at">digits=</span><span class="dv">3</span>,<span class="at">method=</span><span class="st">&quot;likelihood&quot;</span>)</span>
<span id="cb309-29"><a href="week-5-lab.html#cb309-29" tabindex="-1"></a>{</span>
<span id="cb309-30"><a href="week-5-lab.html#cb309-30" tabindex="-1"></a><span class="co"># Asymptotic (or Wald) interval:</span></span>
<span id="cb309-31"><a href="week-5-lab.html#cb309-31" tabindex="-1"></a>  z <span class="ot">=</span> <span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb309-32"><a href="week-5-lab.html#cb309-32" tabindex="-1"></a>  <span class="cf">if</span> (method<span class="sc">==</span><span class="st">&#39;asymptotic&#39;</span>) {</span>
<span id="cb309-33"><a href="week-5-lab.html#cb309-33" tabindex="-1"></a>    se <span class="ot">=</span> <span class="fu">sqrt</span>(p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">/</span>n)</span>
<span id="cb309-34"><a href="week-5-lab.html#cb309-34" tabindex="-1"></a>    CI <span class="ot">=</span> <span class="fu">list</span>(<span class="at">p=</span>p,<span class="at">CI=</span><span class="fu">c</span>((p<span class="sc">-</span>z<span class="sc">*</span>se),(p<span class="sc">+</span>z<span class="sc">*</span>se)),<span class="at">n=</span>n,<span class="at">level=</span><span class="dv">1</span><span class="sc">-</span>alpha,<span class="at">method=</span>method)</span>
<span id="cb309-35"><a href="week-5-lab.html#cb309-35" tabindex="-1"></a>  }</span>
<span id="cb309-36"><a href="week-5-lab.html#cb309-36" tabindex="-1"></a><span class="co"># Asymptotic (or Wald-test) CIs with continuity correction:</span></span>
<span id="cb309-37"><a href="week-5-lab.html#cb309-37" tabindex="-1"></a>  <span class="cf">if</span> (method<span class="sc">==</span><span class="st">&#39;asymptotic.cc&#39;</span>) {</span>
<span id="cb309-38"><a href="week-5-lab.html#cb309-38" tabindex="-1"></a>    se <span class="ot">=</span> <span class="fu">sqrt</span>(p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">/</span>n)</span>
<span id="cb309-39"><a href="week-5-lab.html#cb309-39" tabindex="-1"></a>    CI <span class="ot">=</span> <span class="fu">list</span>(<span class="at">p=</span>p,<span class="at">CI=</span><span class="fu">c</span>((p<span class="sc">-</span>z<span class="sc">*</span>se<span class="dv">-1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>n)),(p<span class="sc">+</span>z<span class="sc">*</span>se<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>n))),<span class="at">n=</span>n,<span class="at">level=</span><span class="dv">1</span><span class="sc">-</span>alpha,</span>
<span id="cb309-40"><a href="week-5-lab.html#cb309-40" tabindex="-1"></a>              <span class="at">method=</span>method)</span>
<span id="cb309-41"><a href="week-5-lab.html#cb309-41" tabindex="-1"></a>  }</span>
<span id="cb309-42"><a href="week-5-lab.html#cb309-42" tabindex="-1"></a><span class="co"># Score test (or Wilson) interval:</span></span>
<span id="cb309-43"><a href="week-5-lab.html#cb309-43" tabindex="-1"></a>  <span class="cf">if</span> (method<span class="sc">==</span><span class="st">&#39;score&#39;</span>) {</span>
<span id="cb309-44"><a href="week-5-lab.html#cb309-44" tabindex="-1"></a>    term1 <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>n<span class="sc">*</span>p <span class="sc">+</span> z<span class="sc">**</span><span class="dv">2</span></span>
<span id="cb309-45"><a href="week-5-lab.html#cb309-45" tabindex="-1"></a>    term2 <span class="ot">=</span> z<span class="sc">*</span><span class="fu">sqrt</span>(z<span class="sc">**</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">4</span><span class="sc">*</span>n<span class="sc">*</span>p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p))</span>
<span id="cb309-46"><a href="week-5-lab.html#cb309-46" tabindex="-1"></a>    term3 <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(n <span class="sc">+</span> z<span class="sc">**</span><span class="dv">2</span>)</span>
<span id="cb309-47"><a href="week-5-lab.html#cb309-47" tabindex="-1"></a>    CI <span class="ot">=</span> <span class="fu">list</span>(<span class="at">p=</span>p,<span class="at">CI=</span><span class="fu">c</span>((term1<span class="sc">-</span>term2)<span class="sc">/</span>term3,(term1<span class="sc">+</span>term2)<span class="sc">/</span>term3),<span class="at">n=</span>n,</span>
<span id="cb309-48"><a href="week-5-lab.html#cb309-48" tabindex="-1"></a>              <span class="at">level=</span><span class="dv">1</span><span class="sc">-</span>alpha,<span class="at">method=</span>method)</span>
<span id="cb309-49"><a href="week-5-lab.html#cb309-49" tabindex="-1"></a>  }</span>
<span id="cb309-50"><a href="week-5-lab.html#cb309-50" tabindex="-1"></a><span class="co"># Score test (or Wilson) interval with continuity correction:</span></span>
<span id="cb309-51"><a href="week-5-lab.html#cb309-51" tabindex="-1"></a>  <span class="cf">if</span> (method<span class="sc">==</span><span class="st">&#39;score.cc&#39;</span>) {</span>
<span id="cb309-52"><a href="week-5-lab.html#cb309-52" tabindex="-1"></a>    term1 <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>n<span class="sc">*</span>p <span class="sc">+</span> z<span class="sc">**</span><span class="dv">2</span></span>
<span id="cb309-53"><a href="week-5-lab.html#cb309-53" tabindex="-1"></a>    <span class="cf">if</span> (p<span class="sc">&gt;</span><span class="dv">0</span>) {</span>
<span id="cb309-54"><a href="week-5-lab.html#cb309-54" tabindex="-1"></a>    term2L <span class="ot">=</span> z<span class="sc">*</span><span class="fu">sqrt</span>(z<span class="sc">**</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">+</span> <span class="dv">4</span><span class="sc">*</span>p<span class="sc">*</span>(n<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb309-55"><a href="week-5-lab.html#cb309-55" tabindex="-1"></a>    }</span>
<span id="cb309-56"><a href="week-5-lab.html#cb309-56" tabindex="-1"></a>    <span class="cf">if</span> (p<span class="sc">&lt;</span><span class="dv">1</span>) {</span>
<span id="cb309-57"><a href="week-5-lab.html#cb309-57" tabindex="-1"></a>    term2U <span class="ot">=</span> z<span class="sc">*</span><span class="fu">sqrt</span>(z<span class="sc">**</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">+</span> <span class="dv">4</span><span class="sc">*</span>p<span class="sc">*</span>(n<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb309-58"><a href="week-5-lab.html#cb309-58" tabindex="-1"></a>    }</span>
<span id="cb309-59"><a href="week-5-lab.html#cb309-59" tabindex="-1"></a>    term3 <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(n <span class="sc">+</span> z<span class="sc">**</span><span class="dv">2</span>)</span>
<span id="cb309-60"><a href="week-5-lab.html#cb309-60" tabindex="-1"></a>    <span class="cf">if</span> ((p<span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">&amp;</span> (p<span class="sc">&lt;</span><span class="dv">1</span>)) {</span>
<span id="cb309-61"><a href="week-5-lab.html#cb309-61" tabindex="-1"></a>      CI <span class="ot">=</span> <span class="fu">list</span>(<span class="at">p=</span>p,<span class="at">CI=</span><span class="fu">c</span>((term1<span class="dv">-1</span><span class="sc">-</span>term2L)<span class="sc">/</span>term3,(term1<span class="sc">+</span><span class="dv">1</span><span class="sc">+</span>term2U)<span class="sc">/</span>term3),<span class="at">n=</span>n,</span>
<span id="cb309-62"><a href="week-5-lab.html#cb309-62" tabindex="-1"></a>                <span class="at">level=</span><span class="dv">1</span><span class="sc">-</span>alpha,<span class="at">method=</span>method)</span>
<span id="cb309-63"><a href="week-5-lab.html#cb309-63" tabindex="-1"></a>    }</span>
<span id="cb309-64"><a href="week-5-lab.html#cb309-64" tabindex="-1"></a>    <span class="cf">if</span> (p<span class="sc">==</span><span class="dv">0</span>) {</span>
<span id="cb309-65"><a href="week-5-lab.html#cb309-65" tabindex="-1"></a>      CI <span class="ot">=</span> <span class="fu">list</span>(<span class="at">p=</span>p,<span class="at">CI=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="at">CIU=</span>(term1<span class="sc">+</span><span class="dv">1</span><span class="sc">+</span>term2U)<span class="sc">/</span>term3),<span class="at">n=</span>n,<span class="at">level=</span><span class="dv">1</span><span class="sc">-</span>alpha,</span>
<span id="cb309-66"><a href="week-5-lab.html#cb309-66" tabindex="-1"></a>                <span class="at">method=</span>method)</span>
<span id="cb309-67"><a href="week-5-lab.html#cb309-67" tabindex="-1"></a>    }</span>
<span id="cb309-68"><a href="week-5-lab.html#cb309-68" tabindex="-1"></a>    <span class="cf">if</span> (p<span class="sc">==</span><span class="dv">1</span>) {</span>
<span id="cb309-69"><a href="week-5-lab.html#cb309-69" tabindex="-1"></a>      CI <span class="ot">=</span> <span class="fu">list</span>(<span class="at">p=</span>p,<span class="at">CI=</span><span class="fu">c</span>((term1<span class="dv">-1</span><span class="sc">-</span>term2L)<span class="sc">/</span>term3,<span class="dv">1</span>),<span class="at">n=</span>n,<span class="at">level=</span><span class="dv">1</span><span class="sc">-</span>alpha,</span>
<span id="cb309-70"><a href="week-5-lab.html#cb309-70" tabindex="-1"></a>                <span class="at">method=</span>method)</span>
<span id="cb309-71"><a href="week-5-lab.html#cb309-71" tabindex="-1"></a>    }</span>
<span id="cb309-72"><a href="week-5-lab.html#cb309-72" tabindex="-1"></a>  }</span>
<span id="cb309-73"><a href="week-5-lab.html#cb309-73" tabindex="-1"></a><span class="co"># Binomial (&#39;exact&#39; or Clopper-Pearson) interval:</span></span>
<span id="cb309-74"><a href="week-5-lab.html#cb309-74" tabindex="-1"></a>  <span class="cf">if</span> (method<span class="sc">==</span><span class="st">&#39;binomial&#39;</span>) {</span>
<span id="cb309-75"><a href="week-5-lab.html#cb309-75" tabindex="-1"></a>    conf.int<span class="ot">=</span><span class="fu">binom.test</span>(<span class="fu">round</span>(p<span class="sc">*</span>n),n,<span class="at">conf.level=</span><span class="dv">1</span><span class="sc">-</span>alpha)<span class="sc">$</span>conf.int</span>
<span id="cb309-76"><a href="week-5-lab.html#cb309-76" tabindex="-1"></a>    CI <span class="ot">=</span> <span class="fu">list</span>(<span class="at">p=</span>p,<span class="at">CI=</span><span class="fu">c</span>(conf.int[<span class="dv">1</span>],conf.int[<span class="dv">2</span>]),<span class="at">n=</span>n,<span class="at">level=</span><span class="dv">1</span><span class="sc">-</span>alpha,<span class="at">method=</span>method)</span>
<span id="cb309-77"><a href="week-5-lab.html#cb309-77" tabindex="-1"></a>  }</span>
<span id="cb309-78"><a href="week-5-lab.html#cb309-78" tabindex="-1"></a><span class="co"># Binomial mid-p quasi-exact interval:</span></span>
<span id="cb309-79"><a href="week-5-lab.html#cb309-79" tabindex="-1"></a>  <span class="cf">if</span> (method<span class="sc">==</span><span class="st">&#39;binomial.midp&#39;</span>) {</span>
<span id="cb309-80"><a href="week-5-lab.html#cb309-80" tabindex="-1"></a>    x <span class="ot">=</span> <span class="fu">round</span>(p<span class="sc">*</span>n)</span>
<span id="cb309-81"><a href="week-5-lab.html#cb309-81" tabindex="-1"></a>    uplim <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb309-82"><a href="week-5-lab.html#cb309-82" tabindex="-1"></a>    lowlim <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb309-83"><a href="week-5-lab.html#cb309-83" tabindex="-1"></a>    <span class="cf">if</span> (x <span class="sc">==</span> <span class="dv">0</span>) uplim <span class="ot">=</span> <span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">**</span>(<span class="dv">1</span><span class="sc">/</span>n)</span>
<span id="cb309-84"><a href="week-5-lab.html#cb309-84" tabindex="-1"></a>    <span class="cf">if</span> (x <span class="sc">==</span> n) lowlim <span class="ot">=</span> alpha<span class="sc">**</span>(<span class="dv">1</span><span class="sc">/</span>n)</span>
<span id="cb309-85"><a href="week-5-lab.html#cb309-85" tabindex="-1"></a>    <span class="cf">if</span> (x <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> x <span class="sc">&lt;</span> n) {</span>
<span id="cb309-86"><a href="week-5-lab.html#cb309-86" tabindex="-1"></a>      pp <span class="ot">=</span> <span class="fu">seq</span>(<span class="fl">0.000001</span>,<span class="fl">0.999999</span>,<span class="at">length=</span><span class="dv">100000</span>)</span>
<span id="cb309-87"><a href="week-5-lab.html#cb309-87" tabindex="-1"></a>      a2 <span class="ot">=</span> <span class="fl">0.5</span><span class="sc">*</span><span class="fu">pbinom</span>(x<span class="dv">-1</span>,n,pp) <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span><span class="fu">pbinom</span>(x,n,pp)</span>
<span id="cb309-88"><a href="week-5-lab.html#cb309-88" tabindex="-1"></a>      uplim <span class="ot">=</span> pp[<span class="fu">max</span>(<span class="fu">which</span>(a2<span class="sc">&gt;</span>(alpha<span class="sc">/</span><span class="dv">2</span>)))]</span>
<span id="cb309-89"><a href="week-5-lab.html#cb309-89" tabindex="-1"></a>      lowlim <span class="ot">=</span> pp[<span class="fu">min</span>(<span class="fu">which</span>(a2<span class="sc">&lt;</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)))]</span>
<span id="cb309-90"><a href="week-5-lab.html#cb309-90" tabindex="-1"></a>    }</span>
<span id="cb309-91"><a href="week-5-lab.html#cb309-91" tabindex="-1"></a>    CI <span class="ot">=</span> <span class="fu">list</span>(<span class="at">p=</span>p,<span class="at">CI=</span><span class="fu">c</span>(lowlim,uplim),<span class="at">n=</span>n,<span class="at">level=</span><span class="dv">1</span><span class="sc">-</span>alpha,<span class="at">method=</span>method)</span>
<span id="cb309-92"><a href="week-5-lab.html#cb309-92" tabindex="-1"></a>  }</span>
<span id="cb309-93"><a href="week-5-lab.html#cb309-93" tabindex="-1"></a><span class="co"># Log-likelihood-ratio interval:</span></span>
<span id="cb309-94"><a href="week-5-lab.html#cb309-94" tabindex="-1"></a>  <span class="cf">if</span> (method<span class="sc">==</span><span class="st">&#39;likelihood&#39;</span>) {</span>
<span id="cb309-95"><a href="week-5-lab.html#cb309-95" tabindex="-1"></a>    x <span class="ot">=</span> <span class="fu">round</span>(p<span class="sc">*</span>n)</span>
<span id="cb309-96"><a href="week-5-lab.html#cb309-96" tabindex="-1"></a>    k <span class="ot">=</span> <span class="sc">-</span><span class="fu">qchisq</span>(<span class="dv">1</span><span class="sc">-</span>alpha,<span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb309-97"><a href="week-5-lab.html#cb309-97" tabindex="-1"></a>    pp <span class="ot">=</span> <span class="fu">seq</span>(<span class="fl">0.000001</span>,<span class="fl">0.999999</span>,<span class="at">length=</span><span class="dv">100000</span>)</span>
<span id="cb309-98"><a href="week-5-lab.html#cb309-98" tabindex="-1"></a>    lik <span class="ot">=</span> <span class="fu">dbinom</span>(x,<span class="at">size=</span>n,pp)</span>
<span id="cb309-99"><a href="week-5-lab.html#cb309-99" tabindex="-1"></a>    logLR <span class="ot">=</span> <span class="fu">log</span>(lik<span class="sc">/</span><span class="fu">max</span>(lik))</span>
<span id="cb309-100"><a href="week-5-lab.html#cb309-100" tabindex="-1"></a>    conf.int<span class="ot">=</span><span class="fu">range</span>(pp[logLR <span class="sc">&gt;</span> k])</span>
<span id="cb309-101"><a href="week-5-lab.html#cb309-101" tabindex="-1"></a>    CI <span class="ot">=</span> <span class="fu">list</span>(<span class="at">p=</span>p,<span class="at">CI=</span><span class="fu">c</span>(conf.int[<span class="dv">1</span>],conf.int[<span class="dv">2</span>]),<span class="at">n=</span>n,<span class="at">level=</span><span class="dv">1</span><span class="sc">-</span>alpha,<span class="at">method=</span>method)</span>
<span id="cb309-102"><a href="week-5-lab.html#cb309-102" tabindex="-1"></a>  }</span>
<span id="cb309-103"><a href="week-5-lab.html#cb309-103" tabindex="-1"></a><span class="co"># Jeffreys prior interval:</span></span>
<span id="cb309-104"><a href="week-5-lab.html#cb309-104" tabindex="-1"></a>  <span class="cf">if</span> (method<span class="sc">==</span><span class="st">&#39;Jeffreys&#39;</span>) {</span>
<span id="cb309-105"><a href="week-5-lab.html#cb309-105" tabindex="-1"></a>    x <span class="ot">=</span> <span class="fu">round</span>(p<span class="sc">*</span>n)</span>
<span id="cb309-106"><a href="week-5-lab.html#cb309-106" tabindex="-1"></a>    conf.int<span class="ot">=</span><span class="fu">qbeta</span>(<span class="fu">c</span>(alpha<span class="sc">/</span><span class="dv">2</span>,<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>),x<span class="fl">+.5</span>,n<span class="sc">-</span>x<span class="fl">+.5</span>)</span>
<span id="cb309-107"><a href="week-5-lab.html#cb309-107" tabindex="-1"></a>    CI <span class="ot">=</span> <span class="fu">list</span>(<span class="at">p=</span>p,<span class="at">CI=</span><span class="fu">c</span>(conf.int[<span class="dv">1</span>],conf.int[<span class="dv">2</span>]),<span class="at">n=</span>n,<span class="at">level=</span><span class="dv">1</span><span class="sc">-</span>alpha,<span class="at">method=</span>method)</span>
<span id="cb309-108"><a href="week-5-lab.html#cb309-108" tabindex="-1"></a>  }</span>
<span id="cb309-109"><a href="week-5-lab.html#cb309-109" tabindex="-1"></a><span class="co"># Agresti-Coull (adding z?/2 successes) interval</span></span>
<span id="cb309-110"><a href="week-5-lab.html#cb309-110" tabindex="-1"></a><span class="co"># (see: http://www.stat.ufl.edu/~aa/cda/R/one_sample/R1/index.html )</span></span>
<span id="cb309-111"><a href="week-5-lab.html#cb309-111" tabindex="-1"></a>  <span class="cf">if</span> (method<span class="sc">==</span><span class="st">&#39;Agresti-Coull&#39;</span>) {</span>
<span id="cb309-112"><a href="week-5-lab.html#cb309-112" tabindex="-1"></a>    x <span class="ot">=</span> <span class="fu">round</span>(p<span class="sc">*</span>n)</span>
<span id="cb309-113"><a href="week-5-lab.html#cb309-113" tabindex="-1"></a>    tr <span class="ot">=</span> z<span class="sc">**</span><span class="dv">2</span></span>
<span id="cb309-114"><a href="week-5-lab.html#cb309-114" tabindex="-1"></a>    suc <span class="ot">=</span> tr<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb309-115"><a href="week-5-lab.html#cb309-115" tabindex="-1"></a>    pp <span class="ot">=</span> (x<span class="sc">+</span>suc)<span class="sc">/</span>(n<span class="sc">+</span>tr)</span>
<span id="cb309-116"><a href="week-5-lab.html#cb309-116" tabindex="-1"></a>    se <span class="ot">=</span> <span class="fu">sqrt</span>(pp<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pp)<span class="sc">/</span>(n<span class="sc">+</span>tr))</span>
<span id="cb309-117"><a href="week-5-lab.html#cb309-117" tabindex="-1"></a>    CI <span class="ot">=</span> <span class="fu">list</span>(<span class="at">p=</span>p,<span class="at">CI=</span><span class="fu">c</span>((pp<span class="sc">-</span>z<span class="sc">*</span>se),(pp<span class="sc">+</span>z<span class="sc">*</span>se)),<span class="at">n=</span>n,<span class="at">level=</span><span class="dv">1</span><span class="sc">-</span>alpha,<span class="at">method=</span>method)</span>
<span id="cb309-118"><a href="week-5-lab.html#cb309-118" tabindex="-1"></a>    <span class="cf">if</span> (CI<span class="sc">$</span>CI[<span class="dv">1</span>] <span class="sc">&lt;</span> <span class="dv">0</span>) CI<span class="sc">$</span>CI[<span class="dv">1</span>]<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb309-119"><a href="week-5-lab.html#cb309-119" tabindex="-1"></a>    <span class="cf">if</span> (CI<span class="sc">$</span>CI[<span class="dv">2</span>] <span class="sc">&gt;</span> <span class="dv">1</span>) CI<span class="sc">$</span>CI[<span class="dv">2</span>]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb309-120"><a href="week-5-lab.html#cb309-120" tabindex="-1"></a>  }</span>
<span id="cb309-121"><a href="week-5-lab.html#cb309-121" tabindex="-1"></a><span class="co"># Agresti-Coull (adding 2 successes and 2 failures) interval:</span></span>
<span id="cb309-122"><a href="week-5-lab.html#cb309-122" tabindex="-1"></a><span class="co"># (see: http://www.stat.ufl.edu/~aa/cda/R/one_sample/R1/index.html )</span></span>
<span id="cb309-123"><a href="week-5-lab.html#cb309-123" tabindex="-1"></a>  <span class="cf">if</span> (method<span class="sc">==</span><span class="st">&#39;Agresti.2_2&#39;</span>) {</span>
<span id="cb309-124"><a href="week-5-lab.html#cb309-124" tabindex="-1"></a>    x <span class="ot">=</span> <span class="fu">round</span>(p<span class="sc">*</span>n)</span>
<span id="cb309-125"><a href="week-5-lab.html#cb309-125" tabindex="-1"></a>    pp <span class="ot">=</span> (x<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span>(n<span class="sc">+</span><span class="dv">4</span>)</span>
<span id="cb309-126"><a href="week-5-lab.html#cb309-126" tabindex="-1"></a>    se <span class="ot">=</span> <span class="fu">sqrt</span>(pp<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pp)<span class="sc">/</span>(n<span class="sc">+</span><span class="dv">4</span>))</span>
<span id="cb309-127"><a href="week-5-lab.html#cb309-127" tabindex="-1"></a>    CI <span class="ot">=</span> <span class="fu">list</span>(<span class="at">p=</span>p,<span class="at">CI=</span><span class="fu">c</span>((pp<span class="sc">-</span>z<span class="sc">*</span>se),(pp<span class="sc">+</span>z<span class="sc">*</span>se)),<span class="at">n=</span>n,<span class="at">level=</span><span class="dv">1</span><span class="sc">-</span>alpha,<span class="at">method=</span>method)</span>
<span id="cb309-128"><a href="week-5-lab.html#cb309-128" tabindex="-1"></a>    <span class="cf">if</span> (CI<span class="sc">$</span>CI[<span class="dv">1</span>] <span class="sc">&lt;</span> <span class="dv">0</span>) CI<span class="sc">$</span>CI[<span class="dv">1</span>]<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb309-129"><a href="week-5-lab.html#cb309-129" tabindex="-1"></a>    <span class="cf">if</span> (CI<span class="sc">$</span>CI[<span class="dv">2</span>] <span class="sc">&gt;</span> <span class="dv">1</span>) CI<span class="sc">$</span>CI[<span class="dv">2</span>]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb309-130"><a href="week-5-lab.html#cb309-130" tabindex="-1"></a>  }</span>
<span id="cb309-131"><a href="week-5-lab.html#cb309-131" tabindex="-1"></a><span class="co"># Logit interval:</span></span>
<span id="cb309-132"><a href="week-5-lab.html#cb309-132" tabindex="-1"></a>  <span class="cf">if</span> (method<span class="sc">==</span><span class="st">&#39;logit&#39;</span>) {</span>
<span id="cb309-133"><a href="week-5-lab.html#cb309-133" tabindex="-1"></a>    lambda <span class="ot">=</span> <span class="fu">log</span>(p<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>p))</span>
<span id="cb309-134"><a href="week-5-lab.html#cb309-134" tabindex="-1"></a>    x <span class="ot">=</span> <span class="fu">round</span>(p<span class="sc">*</span>n)</span>
<span id="cb309-135"><a href="week-5-lab.html#cb309-135" tabindex="-1"></a>    V <span class="ot">=</span> n<span class="sc">/</span>(x<span class="sc">*</span>(n<span class="sc">-</span>x))</span>
<span id="cb309-136"><a href="week-5-lab.html#cb309-136" tabindex="-1"></a>    conf.int <span class="ot">=</span> (<span class="fu">c</span>(lambda <span class="sc">-</span> z<span class="sc">*</span><span class="fu">sqrt</span>(V),lambda <span class="sc">+</span> z<span class="sc">*</span><span class="fu">sqrt</span>(V)))</span>
<span id="cb309-137"><a href="week-5-lab.html#cb309-137" tabindex="-1"></a>    conf.int <span class="ot">=</span> <span class="fu">exp</span>(conf.int)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(conf.int))</span>
<span id="cb309-138"><a href="week-5-lab.html#cb309-138" tabindex="-1"></a>    CI <span class="ot">=</span> <span class="fu">list</span>(<span class="at">p=</span>p,<span class="at">CI=</span><span class="fu">c</span>(conf.int[<span class="dv">1</span>],conf.int[<span class="dv">2</span>]),<span class="at">n=</span>n,<span class="at">level=</span><span class="dv">1</span><span class="sc">-</span>alpha,<span class="at">method=</span>method)</span>
<span id="cb309-139"><a href="week-5-lab.html#cb309-139" tabindex="-1"></a>  }</span>
<span id="cb309-140"><a href="week-5-lab.html#cb309-140" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;p ? &#39;</span>,<span class="dv">100</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>alpha),<span class="st">&#39;%-CI = &#39;</span>,<span class="fu">round</span>(p,digits),<span class="st">&#39; (&#39;</span>,</span>
<span id="cb309-141"><a href="week-5-lab.html#cb309-141" tabindex="-1"></a>      <span class="fu">round</span>(CI<span class="sc">$</span>CI[<span class="dv">1</span>],digits),<span class="st">&#39;; &#39;</span>,<span class="fu">round</span>(CI<span class="sc">$</span>CI[<span class="dv">2</span>],digits),<span class="st">&#39;)</span><span class="sc">\n</span><span class="st">&#39;</span>,<span class="at">sep=</span><span class="st">&#39;&#39;</span>)</span>
<span id="cb309-142"><a href="week-5-lab.html#cb309-142" tabindex="-1"></a>  CI</span>
<span id="cb309-143"><a href="week-5-lab.html#cb309-143" tabindex="-1"></a>}</span>
<span id="cb309-144"><a href="week-5-lab.html#cb309-144" tabindex="-1"></a></span>
<span id="cb309-145"><a href="week-5-lab.html#cb309-145" tabindex="-1"></a><span class="co"># The following example  reproduces the data of Table I of Newcombe (1998,</span></span>
<span id="cb309-146"><a href="week-5-lab.html#cb309-146" tabindex="-1"></a><span class="co"># p. 861). Other methods to calculate confidence intervals of a single propor-</span></span>
<span id="cb309-147"><a href="week-5-lab.html#cb309-147" tabindex="-1"></a><span class="co"># tion as discussed in Brown et al. (2001) will also be demonstrated.</span></span>
<span id="cb309-148"><a href="week-5-lab.html#cb309-148" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb309-149"><a href="week-5-lab.html#cb309-149" tabindex="-1"></a><span class="co"># To run, de-comment the following line:</span></span>
<span id="cb309-150"><a href="week-5-lab.html#cb309-150" tabindex="-1"></a><span class="co"># source(&quot;http://www2.jura.uni-hamburg.de/instkrim/kriminologie/Mitarbeiter/Enzmann/Software/ex_prop.CI.r&quot;)</span></span></code></pre></div>
<p>I will use this code to calculate the confidence intervals for the binomial proportion if I get 2 successes out of 100 trials.</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="week-5-lab.html#cb310-1" tabindex="-1"></a>ci<span class="fl">.1</span>C1 <span class="ot">=</span><span class="fu">prop.CI</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">100</span>,<span class="dv">100</span>,<span class="at">digits=</span><span class="dv">4</span>,<span class="at">method=</span><span class="st">&#39;asymptotic&#39;</span>)<span class="sc">$</span>CI</span></code></pre></div>
<pre><code>## p ? 95%-CI = 0.02 (-0.0074; 0.0474)</code></pre>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="week-5-lab.html#cb312-1" tabindex="-1"></a>ci<span class="fl">.2</span>C1 <span class="ot">=</span><span class="fu">prop.CI</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">100</span>,<span class="dv">100</span>,<span class="at">digits=</span><span class="dv">4</span>,<span class="at">method=</span><span class="st">&#39;asymptotic.cc&#39;</span>)<span class="sc">$</span>CI</span></code></pre></div>
<pre><code>## p ? 95%-CI = 0.02 (-0.0124; 0.0524)</code></pre>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="week-5-lab.html#cb314-1" tabindex="-1"></a>ci<span class="fl">.3</span>C1 <span class="ot">=</span><span class="fu">prop.CI</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">100</span>,<span class="dv">100</span>,<span class="at">digits=</span><span class="dv">4</span>,<span class="at">method=</span><span class="st">&#39;score&#39;</span>)<span class="sc">$</span>CI</span></code></pre></div>
<pre><code>## p ? 95%-CI = 0.02 (0.0055; 0.07)</code></pre>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="week-5-lab.html#cb316-1" tabindex="-1"></a>ci<span class="fl">.4</span>C1 <span class="ot">=</span><span class="fu">prop.CI</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">100</span>,<span class="dv">100</span>,<span class="at">digits=</span><span class="dv">4</span>,<span class="at">method=</span><span class="st">&#39;score.cc&#39;</span>)<span class="sc">$</span>CI</span></code></pre></div>
<pre><code>## p ? 95%-CI = 0.02 (0.0035; 0.0774)</code></pre>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="week-5-lab.html#cb318-1" tabindex="-1"></a>ci<span class="fl">.5</span>C1 <span class="ot">=</span><span class="fu">prop.CI</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">100</span>,<span class="dv">100</span>,<span class="at">digits=</span><span class="dv">4</span>,<span class="at">method=</span><span class="st">&#39;binomial&#39;</span>)<span class="sc">$</span>CI</span></code></pre></div>
<pre><code>## p ? 95%-CI = 0.02 (0.0024; 0.0704)</code></pre>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="week-5-lab.html#cb320-1" tabindex="-1"></a>ci<span class="fl">.6</span>C1 <span class="ot">=</span><span class="fu">prop.CI</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">100</span>,<span class="dv">100</span>,<span class="at">digits=</span><span class="dv">4</span>,<span class="at">method=</span><span class="st">&#39;binomial.midp&#39;</span>)<span class="sc">$</span>CI</span></code></pre></div>
<pre><code>## p ? 95%-CI = 0.02 (0.0034; 0.0645)</code></pre>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="week-5-lab.html#cb322-1" tabindex="-1"></a>ci<span class="fl">.7</span>C1 <span class="ot">=</span><span class="fu">prop.CI</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">100</span>,<span class="dv">100</span>,<span class="at">digits=</span><span class="dv">4</span>)<span class="sc">$</span>CI</span></code></pre></div>
<pre><code>## p ? 95%-CI = 0.02 (0.0034; 0.0605)</code></pre>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="week-5-lab.html#cb324-1" tabindex="-1"></a>ci<span class="fl">.8</span>C1 <span class="ot">=</span><span class="fu">prop.CI</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">100</span>,<span class="dv">100</span>,<span class="at">digits=</span><span class="dv">4</span>,<span class="at">method=</span><span class="st">&#39;Jeffreys&#39;</span>)<span class="sc">$</span>CI</span></code></pre></div>
<pre><code>## p ? 95%-CI = 0.02 (0.0042; 0.0626)</code></pre>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="week-5-lab.html#cb326-1" tabindex="-1"></a>ci<span class="fl">.9</span>C1 <span class="ot">=</span><span class="fu">prop.CI</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">100</span>,<span class="dv">100</span>,<span class="at">digits=</span><span class="dv">4</span>,<span class="at">method=</span><span class="st">&#39;Agresti-Coull&#39;</span>)<span class="sc">$</span>CI</span></code></pre></div>
<pre><code>## p ? 95%-CI = 0.02 (0.0011; 0.0744)</code></pre>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="week-5-lab.html#cb328-1" tabindex="-1"></a>ci<span class="fl">.10</span>C1<span class="ot">=</span><span class="fu">prop.CI</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">100</span>,<span class="dv">100</span>,<span class="at">digits=</span><span class="dv">4</span>,<span class="at">method=</span><span class="st">&#39;Agresti.2_2&#39;</span>)<span class="sc">$</span>CI</span></code></pre></div>
<pre><code>## p ? 95%-CI = 0.02 (0.0015; 0.0754)</code></pre>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="week-5-lab.html#cb330-1" tabindex="-1"></a>ci<span class="fl">.11</span>C1<span class="ot">=</span><span class="fu">prop.CI</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">100</span>,<span class="dv">100</span>,<span class="at">digits=</span><span class="dv">4</span>,<span class="at">method=</span><span class="st">&#39;logit&#39;</span>)<span class="sc">$</span>CI</span></code></pre></div>
<pre><code>## p ? 95%-CI = 0.02 (0.005; 0.0764)</code></pre>
<p>We see that most of these methods correctly constrain the CIs to be bounded by [0,1].</p>
</div>
<div id="comparing-two-distributions-1" class="section level2 hasAnchor" number="10.4">
<h2><span class="header-section-number">10.4</span> Comparing two distributions<a href="week-5-lab.html#comparing-two-distributions-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To perform the K-S test to compare two distributions, we need to simulate some data. We will plot their (empirical) cumulative distributions using the function “ecdf”.</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="week-5-lab.html#cb332-1" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb332-2"><a href="week-5-lab.html#cb332-2" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">30</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb332-3"><a href="week-5-lab.html#cb332-3" tabindex="-1"></a><span class="fu">ks.test</span>(x,y)</span></code></pre></div>
<pre><code>## 
##  Two-sample Kolmogorov-Smirnov test
## 
## data:  x and y
## D = 0.56667, p-value = 4.58e-06
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="week-5-lab.html#cb334-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ecdf</span>(x))</span>
<span id="cb334-2"><a href="week-5-lab.html#cb334-2" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ecdf</span>(y),<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="Week-5-lab_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="week-5-lecture.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="week-6-lecture.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
